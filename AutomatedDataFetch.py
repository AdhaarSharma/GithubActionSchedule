{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "fab4415e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['NIFTY', 'FINNIFTY', 'BANKNIFTY']\n"
     ]
    }
   ],
   "source": [
    "import requests\n",
    "from nsepython import *   \n",
    "print(indices)\n",
    "import datetime\n",
    "from pynse import *\n",
    "nse=Nse()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "bd6b97b4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>1</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>symbol</td>\n",
       "      <td>SBIN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>companyName</td>\n",
       "      <td>State Bank of India</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>industry</td>\n",
       "      <td>BANKS</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>activeSeries</td>\n",
       "      <td>[EQ]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>debtSeries</td>\n",
       "      <td>[]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>tempSuspendedSeries</td>\n",
       "      <td>[IL, N1, N2, N3, N4, N5, N6]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>isFNOSec</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>isCASec</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>isSLBSec</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>isDebtSec</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>isSuspended</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>isETFSec</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>isDelisted</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>isin</td>\n",
       "      <td>INE062A08066</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                      0                             1\n",
       "0                symbol                          SBIN\n",
       "1           companyName           State Bank of India\n",
       "2              industry                         BANKS\n",
       "3          activeSeries                          [EQ]\n",
       "4            debtSeries                            []\n",
       "5   tempSuspendedSeries  [IL, N1, N2, N3, N4, N5, N6]\n",
       "6              isFNOSec                          True\n",
       "7               isCASec                         False\n",
       "8              isSLBSec                          True\n",
       "9             isDebtSec                         False\n",
       "10          isSuspended                         False\n",
       "11             isETFSec                         False\n",
       "12           isDelisted                         False\n",
       "13                 isin                  INE062A08066"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "A = nse.info('SBIN')\n",
    "df1 = pd.DataFrame(A.items())\n",
    "df1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "a7a4dd1f",
   "metadata": {},
   "outputs": [],
   "source": [
    "def export_csv(df):\n",
    "  with io.StringIO() as buffer:\n",
    "    df.to_csv(buffer)\n",
    "    return buffer.getvalue()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "9c4ad190",
   "metadata": {},
   "outputs": [],
   "source": [
    "buffer = io.BytesIO()\n",
    "buffer.write(export_csv(df1).encode())\n",
    "buffer.seek(0)\n",
    "buffer.name = f'SBIN.csv'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "b0ca0d23",
   "metadata": {},
   "outputs": [],
   "source": [
    "base_url = \"https://api.telegram.org/bot2116923117:AAFccongYIN7CJwXcIjMbtidduE6IiYEFuM/sendDocument\"\n",
    "\n",
    "parameters = {\n",
    "    \"chat_id\" : \"-777737632\",\n",
    "    \"caption\" : \"SBIN\"\n",
    "}\n",
    "\n",
    "files = {\n",
    "    \"document\" : buffer\n",
    "}\n",
    "\n",
    "resp = requests.get(base_url, data = parameters, files = files)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "61c82c98",
   "metadata": {},
   "outputs": [],
   "source": [
    "nse.update_symbol_list()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "ed0609ac",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>col</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NIFTY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NIFTYIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>BANKNIFTY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>FSL</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>COFORGE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>186</th>\n",
       "      <td>CHOLAFIN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>187</th>\n",
       "      <td>SYNGENE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>188</th>\n",
       "      <td>TORNTPHARM</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>189</th>\n",
       "      <td>BIOCON</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>190</th>\n",
       "      <td>L&amp;TFH</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>191 rows × 1 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            col\n",
       "0         NIFTY\n",
       "1       NIFTYIT\n",
       "2     BANKNIFTY\n",
       "3           FSL\n",
       "4       COFORGE\n",
       "..          ...\n",
       "186    CHOLAFIN\n",
       "187     SYNGENE\n",
       "188  TORNTPHARM\n",
       "189      BIOCON\n",
       "190       L&TFH\n",
       "\n",
       "[191 rows x 1 columns]"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "A = fnolist()\n",
    "df2 = pd.DataFrame({'col':A})\n",
    "df2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "de3c6f3c",
   "metadata": {},
   "outputs": [],
   "source": [
    "buffer = io.BytesIO()\n",
    "buffer.write(export_csv(df2).encode())\n",
    "buffer.seek(0)\n",
    "buffer.name = f'fnolist.csv'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "076ad021",
   "metadata": {},
   "outputs": [],
   "source": [
    "base_url = \"https://api.telegram.org/bot2116923117:AAFccongYIN7CJwXcIjMbtidduE6IiYEFuM/sendDocument\"\n",
    "\n",
    "parameters = {\n",
    "    \"chat_id\" : \"-777737632\",\n",
    "    \"caption\" : \"fnolist\"\n",
    "}\n",
    "\n",
    "files = {\n",
    "    \"document\" : buffer\n",
    "}\n",
    "\n",
    "resp = requests.get(base_url, data = parameters, files = files)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "0c033395",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "False\n"
     ]
    }
   ],
   "source": [
    "print(running_status())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "536e628e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'marketState': [{'market': 'Capital Market',\n",
       "   'marketStatus': 'Closed',\n",
       "   'tradeDate': '27-Dec-2021',\n",
       "   'index': 'NIFTY 50',\n",
       "   'last': 17003.75,\n",
       "   'variation': -68.84999999999854,\n",
       "   'percentChange': -0.4,\n",
       "   'marketStatusMessage': 'Normal Market has Closed'},\n",
       "  {'market': 'Currency',\n",
       "   'marketStatus': 'Closed',\n",
       "   'tradeDate': '27-Dec-2021',\n",
       "   'index': '',\n",
       "   'last': '',\n",
       "   'variation': '',\n",
       "   'percentChange': '',\n",
       "   'marketStatusMessage': 'Market is Closed'},\n",
       "  {'market': 'Commodity',\n",
       "   'marketStatus': 'Closed',\n",
       "   'tradeDate': '27-Dec-2021',\n",
       "   'index': '',\n",
       "   'last': '',\n",
       "   'variation': '',\n",
       "   'percentChange': '',\n",
       "   'marketStatusMessage': 'Market is Closed'},\n",
       "  {'market': 'Debt',\n",
       "   'marketStatus': 'Closed',\n",
       "   'tradeDate': '27-Dec-2021',\n",
       "   'index': '',\n",
       "   'last': '',\n",
       "   'variation': '',\n",
       "   'percentChange': '',\n",
       "   'marketStatusMessage': 'Market is Closed'}]}"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nse.market_status()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "5443828b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>metadata.identifier</th>\n",
       "      <th>metadata.purpose</th>\n",
       "      <th>metadata.lastPrice</th>\n",
       "      <th>metadata.change</th>\n",
       "      <th>metadata.pChange</th>\n",
       "      <th>metadata.previousClose</th>\n",
       "      <th>metadata.finalQuantity</th>\n",
       "      <th>metadata.totalTurnover</th>\n",
       "      <th>metadata.marketCap</th>\n",
       "      <th>metadata.yearHigh</th>\n",
       "      <th>...</th>\n",
       "      <th>detail.preOpenMarket.ato.totalSellQuantity</th>\n",
       "      <th>detail.preOpenMarket.IEP</th>\n",
       "      <th>detail.preOpenMarket.totalTradedVolume</th>\n",
       "      <th>detail.preOpenMarket.finalPrice</th>\n",
       "      <th>detail.preOpenMarket.finalQuantity</th>\n",
       "      <th>detail.preOpenMarket.lastUpdateTime</th>\n",
       "      <th>detail.preOpenMarket.totalSellQuantity</th>\n",
       "      <th>detail.preOpenMarket.totalBuyQuantity</th>\n",
       "      <th>detail.preOpenMarket.atoBuyQty</th>\n",
       "      <th>detail.preOpenMarket.atoSellQty</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>metadata.symbol</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>MITTAL</th>\n",
       "      <td>MITTALEQN</td>\n",
       "      <td>BONUS 1:10</td>\n",
       "      <td>15.50</td>\n",
       "      <td>1.90</td>\n",
       "      <td>13.970588</td>\n",
       "      <td>13.60</td>\n",
       "      <td>176952</td>\n",
       "      <td>2742756.00</td>\n",
       "      <td>-</td>\n",
       "      <td>14.32</td>\n",
       "      <td>...</td>\n",
       "      <td>2294</td>\n",
       "      <td>15.50</td>\n",
       "      <td>176952</td>\n",
       "      <td>15.50</td>\n",
       "      <td>176952</td>\n",
       "      <td>2021-12-24 09:07:37</td>\n",
       "      <td>168587</td>\n",
       "      <td>175626</td>\n",
       "      <td>131128</td>\n",
       "      <td>2294</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>BRIGHT</th>\n",
       "      <td>BRIGHTSMN</td>\n",
       "      <td>None</td>\n",
       "      <td>7.20</td>\n",
       "      <td>0.85</td>\n",
       "      <td>13.385827</td>\n",
       "      <td>6.35</td>\n",
       "      <td>171000</td>\n",
       "      <td>1231200.00</td>\n",
       "      <td>-</td>\n",
       "      <td>15.55</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>7.20</td>\n",
       "      <td>171000</td>\n",
       "      <td>7.20</td>\n",
       "      <td>171000</td>\n",
       "      <td>2021-12-24 09:07:33</td>\n",
       "      <td>216000</td>\n",
       "      <td>117000</td>\n",
       "      <td>27000</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>VISESHINFO</th>\n",
       "      <td>VISESHINFOBEN</td>\n",
       "      <td>None</td>\n",
       "      <td>0.45</td>\n",
       "      <td>0.05</td>\n",
       "      <td>12.500000</td>\n",
       "      <td>0.40</td>\n",
       "      <td>44131706</td>\n",
       "      <td>19859267.70</td>\n",
       "      <td>-</td>\n",
       "      <td>0.40</td>\n",
       "      <td>...</td>\n",
       "      <td>60600</td>\n",
       "      <td>0.45</td>\n",
       "      <td>44131706</td>\n",
       "      <td>0.45</td>\n",
       "      <td>44131706</td>\n",
       "      <td>2021-12-24 09:07:34</td>\n",
       "      <td>0</td>\n",
       "      <td>195729461</td>\n",
       "      <td>0</td>\n",
       "      <td>37799037</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PTL</th>\n",
       "      <td>PTLEQN</td>\n",
       "      <td>FACE VALUE SPLIT (SUB-DIVISION) - FROM RS 2/-...</td>\n",
       "      <td>36.75</td>\n",
       "      <td>3.75</td>\n",
       "      <td>11.363636</td>\n",
       "      <td>33.00</td>\n",
       "      <td>56728</td>\n",
       "      <td>2084754.00</td>\n",
       "      <td>-</td>\n",
       "      <td>33.00</td>\n",
       "      <td>...</td>\n",
       "      <td>30</td>\n",
       "      <td>36.75</td>\n",
       "      <td>56728</td>\n",
       "      <td>36.75</td>\n",
       "      <td>56728</td>\n",
       "      <td>2021-12-24 09:07:36</td>\n",
       "      <td>183421</td>\n",
       "      <td>101638</td>\n",
       "      <td>23568</td>\n",
       "      <td>30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>AIRAN</th>\n",
       "      <td>AIRANEQN</td>\n",
       "      <td>ANNUAL GENERAL MEETING</td>\n",
       "      <td>25.70</td>\n",
       "      <td>2.20</td>\n",
       "      <td>9.361702</td>\n",
       "      <td>23.50</td>\n",
       "      <td>9905</td>\n",
       "      <td>254558.50</td>\n",
       "      <td>-</td>\n",
       "      <td>35.95</td>\n",
       "      <td>...</td>\n",
       "      <td>3</td>\n",
       "      <td>25.70</td>\n",
       "      <td>9905</td>\n",
       "      <td>25.70</td>\n",
       "      <td>9905</td>\n",
       "      <td>2021-12-24 09:07:34</td>\n",
       "      <td>12199</td>\n",
       "      <td>14685</td>\n",
       "      <td>9905</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ARTNIRMAN</th>\n",
       "      <td>ARTNIRMANBEN</td>\n",
       "      <td>None</td>\n",
       "      <td>117.75</td>\n",
       "      <td>-6.15</td>\n",
       "      <td>-4.963680</td>\n",
       "      <td>123.90</td>\n",
       "      <td>36</td>\n",
       "      <td>4239.00</td>\n",
       "      <td>-</td>\n",
       "      <td>195.90</td>\n",
       "      <td>...</td>\n",
       "      <td>10237</td>\n",
       "      <td>117.75</td>\n",
       "      <td>36</td>\n",
       "      <td>117.75</td>\n",
       "      <td>36</td>\n",
       "      <td>2021-12-24 09:07:34</td>\n",
       "      <td>22291</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>107</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>AXISCADES</th>\n",
       "      <td>AXISCADESEQN</td>\n",
       "      <td>ANNUAL GENERAL MEETING</td>\n",
       "      <td>106.60</td>\n",
       "      <td>-5.60</td>\n",
       "      <td>-4.991087</td>\n",
       "      <td>112.20</td>\n",
       "      <td>3810</td>\n",
       "      <td>406146.00</td>\n",
       "      <td>-</td>\n",
       "      <td>120.40</td>\n",
       "      <td>...</td>\n",
       "      <td>4159</td>\n",
       "      <td>106.60</td>\n",
       "      <td>3810</td>\n",
       "      <td>106.60</td>\n",
       "      <td>3810</td>\n",
       "      <td>2021-12-24 09:07:34</td>\n",
       "      <td>185148</td>\n",
       "      <td>0</td>\n",
       "      <td>365</td>\n",
       "      <td>4159</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>TTML</th>\n",
       "      <td>TTMLBEN</td>\n",
       "      <td>None</td>\n",
       "      <td>146.40</td>\n",
       "      <td>-7.70</td>\n",
       "      <td>-4.996755</td>\n",
       "      <td>154.10</td>\n",
       "      <td>353040</td>\n",
       "      <td>51685056.00</td>\n",
       "      <td>-</td>\n",
       "      <td>189.10</td>\n",
       "      <td>...</td>\n",
       "      <td>708626</td>\n",
       "      <td>146.40</td>\n",
       "      <td>351238</td>\n",
       "      <td>146.40</td>\n",
       "      <td>353040</td>\n",
       "      <td>2021-12-24 09:07:34</td>\n",
       "      <td>1940609</td>\n",
       "      <td>0</td>\n",
       "      <td>27621</td>\n",
       "      <td>708626</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>FOCUS</th>\n",
       "      <td>FOCUSEQN</td>\n",
       "      <td>None</td>\n",
       "      <td>76.05</td>\n",
       "      <td>-4.00</td>\n",
       "      <td>-4.996877</td>\n",
       "      <td>80.05</td>\n",
       "      <td>616</td>\n",
       "      <td>46846.80</td>\n",
       "      <td>-</td>\n",
       "      <td>90.85</td>\n",
       "      <td>...</td>\n",
       "      <td>6000</td>\n",
       "      <td>76.05</td>\n",
       "      <td>616</td>\n",
       "      <td>76.05</td>\n",
       "      <td>616</td>\n",
       "      <td>2021-12-24 09:07:36</td>\n",
       "      <td>10385</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>300</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>JPOLYINVST</th>\n",
       "      <td>JPOLYINVSTBEN</td>\n",
       "      <td>None</td>\n",
       "      <td>277.55</td>\n",
       "      <td>-14.60</td>\n",
       "      <td>-4.997433</td>\n",
       "      <td>292.15</td>\n",
       "      <td>1309</td>\n",
       "      <td>363312.95</td>\n",
       "      <td>-</td>\n",
       "      <td>448.35</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>277.55</td>\n",
       "      <td>0</td>\n",
       "      <td>277.55</td>\n",
       "      <td>1309</td>\n",
       "      <td>2021-12-24 09:07:38</td>\n",
       "      <td>4662</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1502 rows × 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                metadata.identifier  \\\n",
       "metadata.symbol                       \n",
       "MITTAL                    MITTALEQN   \n",
       "BRIGHT                    BRIGHTSMN   \n",
       "VISESHINFO            VISESHINFOBEN   \n",
       "PTL                          PTLEQN   \n",
       "AIRAN                      AIRANEQN   \n",
       "...                             ...   \n",
       "ARTNIRMAN              ARTNIRMANBEN   \n",
       "AXISCADES              AXISCADESEQN   \n",
       "TTML                        TTMLBEN   \n",
       "FOCUS                      FOCUSEQN   \n",
       "JPOLYINVST            JPOLYINVSTBEN   \n",
       "\n",
       "                                                  metadata.purpose  \\\n",
       "metadata.symbol                                                      \n",
       "MITTAL                                                  BONUS 1:10   \n",
       "BRIGHT                                                        None   \n",
       "VISESHINFO                                                    None   \n",
       "PTL               FACE VALUE SPLIT (SUB-DIVISION) - FROM RS 2/-...   \n",
       "AIRAN                                       ANNUAL GENERAL MEETING   \n",
       "...                                                            ...   \n",
       "ARTNIRMAN                                                     None   \n",
       "AXISCADES                                   ANNUAL GENERAL MEETING   \n",
       "TTML                                                          None   \n",
       "FOCUS                                                         None   \n",
       "JPOLYINVST                                                    None   \n",
       "\n",
       "                 metadata.lastPrice  metadata.change  metadata.pChange  \\\n",
       "metadata.symbol                                                          \n",
       "MITTAL                        15.50             1.90         13.970588   \n",
       "BRIGHT                         7.20             0.85         13.385827   \n",
       "VISESHINFO                     0.45             0.05         12.500000   \n",
       "PTL                           36.75             3.75         11.363636   \n",
       "AIRAN                         25.70             2.20          9.361702   \n",
       "...                             ...              ...               ...   \n",
       "ARTNIRMAN                    117.75            -6.15         -4.963680   \n",
       "AXISCADES                    106.60            -5.60         -4.991087   \n",
       "TTML                         146.40            -7.70         -4.996755   \n",
       "FOCUS                         76.05            -4.00         -4.996877   \n",
       "JPOLYINVST                   277.55           -14.60         -4.997433   \n",
       "\n",
       "                 metadata.previousClose  metadata.finalQuantity  \\\n",
       "metadata.symbol                                                   \n",
       "MITTAL                            13.60                  176952   \n",
       "BRIGHT                             6.35                  171000   \n",
       "VISESHINFO                         0.40                44131706   \n",
       "PTL                               33.00                   56728   \n",
       "AIRAN                             23.50                    9905   \n",
       "...                                 ...                     ...   \n",
       "ARTNIRMAN                        123.90                      36   \n",
       "AXISCADES                        112.20                    3810   \n",
       "TTML                             154.10                  353040   \n",
       "FOCUS                             80.05                     616   \n",
       "JPOLYINVST                       292.15                    1309   \n",
       "\n",
       "                 metadata.totalTurnover metadata.marketCap  metadata.yearHigh  \\\n",
       "metadata.symbol                                                                 \n",
       "MITTAL                       2742756.00                  -              14.32   \n",
       "BRIGHT                       1231200.00                  -              15.55   \n",
       "VISESHINFO                  19859267.70                  -               0.40   \n",
       "PTL                          2084754.00                  -              33.00   \n",
       "AIRAN                         254558.50                  -              35.95   \n",
       "...                                 ...                ...                ...   \n",
       "ARTNIRMAN                       4239.00                  -             195.90   \n",
       "AXISCADES                     406146.00                  -             120.40   \n",
       "TTML                        51685056.00                  -             189.10   \n",
       "FOCUS                          46846.80                  -              90.85   \n",
       "JPOLYINVST                    363312.95                  -             448.35   \n",
       "\n",
       "                 ...  detail.preOpenMarket.ato.totalSellQuantity  \\\n",
       "metadata.symbol  ...                                               \n",
       "MITTAL           ...                                        2294   \n",
       "BRIGHT           ...                                           0   \n",
       "VISESHINFO       ...                                       60600   \n",
       "PTL              ...                                          30   \n",
       "AIRAN            ...                                           3   \n",
       "...              ...                                         ...   \n",
       "ARTNIRMAN        ...                                       10237   \n",
       "AXISCADES        ...                                        4159   \n",
       "TTML             ...                                      708626   \n",
       "FOCUS            ...                                        6000   \n",
       "JPOLYINVST       ...                                           0   \n",
       "\n",
       "                 detail.preOpenMarket.IEP  \\\n",
       "metadata.symbol                             \n",
       "MITTAL                              15.50   \n",
       "BRIGHT                               7.20   \n",
       "VISESHINFO                           0.45   \n",
       "PTL                                 36.75   \n",
       "AIRAN                               25.70   \n",
       "...                                   ...   \n",
       "ARTNIRMAN                          117.75   \n",
       "AXISCADES                          106.60   \n",
       "TTML                               146.40   \n",
       "FOCUS                               76.05   \n",
       "JPOLYINVST                         277.55   \n",
       "\n",
       "                detail.preOpenMarket.totalTradedVolume  \\\n",
       "metadata.symbol                                          \n",
       "MITTAL                                          176952   \n",
       "BRIGHT                                          171000   \n",
       "VISESHINFO                                    44131706   \n",
       "PTL                                              56728   \n",
       "AIRAN                                             9905   \n",
       "...                                                ...   \n",
       "ARTNIRMAN                                           36   \n",
       "AXISCADES                                         3810   \n",
       "TTML                                            351238   \n",
       "FOCUS                                              616   \n",
       "JPOLYINVST                                           0   \n",
       "\n",
       "                detail.preOpenMarket.finalPrice  \\\n",
       "metadata.symbol                                   \n",
       "MITTAL                                    15.50   \n",
       "BRIGHT                                     7.20   \n",
       "VISESHINFO                                 0.45   \n",
       "PTL                                       36.75   \n",
       "AIRAN                                     25.70   \n",
       "...                                         ...   \n",
       "ARTNIRMAN                                117.75   \n",
       "AXISCADES                                106.60   \n",
       "TTML                                     146.40   \n",
       "FOCUS                                     76.05   \n",
       "JPOLYINVST                               277.55   \n",
       "\n",
       "                 detail.preOpenMarket.finalQuantity  \\\n",
       "metadata.symbol                                       \n",
       "MITTAL                                       176952   \n",
       "BRIGHT                                       171000   \n",
       "VISESHINFO                                 44131706   \n",
       "PTL                                           56728   \n",
       "AIRAN                                          9905   \n",
       "...                                             ...   \n",
       "ARTNIRMAN                                        36   \n",
       "AXISCADES                                      3810   \n",
       "TTML                                         353040   \n",
       "FOCUS                                           616   \n",
       "JPOLYINVST                                     1309   \n",
       "\n",
       "                 detail.preOpenMarket.lastUpdateTime  \\\n",
       "metadata.symbol                                        \n",
       "MITTAL                           2021-12-24 09:07:37   \n",
       "BRIGHT                           2021-12-24 09:07:33   \n",
       "VISESHINFO                       2021-12-24 09:07:34   \n",
       "PTL                              2021-12-24 09:07:36   \n",
       "AIRAN                            2021-12-24 09:07:34   \n",
       "...                                              ...   \n",
       "ARTNIRMAN                        2021-12-24 09:07:34   \n",
       "AXISCADES                        2021-12-24 09:07:34   \n",
       "TTML                             2021-12-24 09:07:34   \n",
       "FOCUS                            2021-12-24 09:07:36   \n",
       "JPOLYINVST                       2021-12-24 09:07:38   \n",
       "\n",
       "                 detail.preOpenMarket.totalSellQuantity  \\\n",
       "metadata.symbol                                           \n",
       "MITTAL                                           168587   \n",
       "BRIGHT                                           216000   \n",
       "VISESHINFO                                            0   \n",
       "PTL                                              183421   \n",
       "AIRAN                                             12199   \n",
       "...                                                 ...   \n",
       "ARTNIRMAN                                         22291   \n",
       "AXISCADES                                        185148   \n",
       "TTML                                            1940609   \n",
       "FOCUS                                             10385   \n",
       "JPOLYINVST                                         4662   \n",
       "\n",
       "                 detail.preOpenMarket.totalBuyQuantity  \\\n",
       "metadata.symbol                                          \n",
       "MITTAL                                          175626   \n",
       "BRIGHT                                          117000   \n",
       "VISESHINFO                                   195729461   \n",
       "PTL                                             101638   \n",
       "AIRAN                                            14685   \n",
       "...                                                ...   \n",
       "ARTNIRMAN                                            0   \n",
       "AXISCADES                                            0   \n",
       "TTML                                                 0   \n",
       "FOCUS                                                0   \n",
       "JPOLYINVST                                           0   \n",
       "\n",
       "                 detail.preOpenMarket.atoBuyQty  \\\n",
       "metadata.symbol                                   \n",
       "MITTAL                                   131128   \n",
       "BRIGHT                                    27000   \n",
       "VISESHINFO                                    0   \n",
       "PTL                                       23568   \n",
       "AIRAN                                      9905   \n",
       "...                                         ...   \n",
       "ARTNIRMAN                                     0   \n",
       "AXISCADES                                   365   \n",
       "TTML                                      27621   \n",
       "FOCUS                                         0   \n",
       "JPOLYINVST                                    0   \n",
       "\n",
       "                 detail.preOpenMarket.atoSellQty  \n",
       "metadata.symbol                                   \n",
       "MITTAL                                      2294  \n",
       "BRIGHT                                         0  \n",
       "VISESHINFO                              37799037  \n",
       "PTL                                           30  \n",
       "AIRAN                                          3  \n",
       "...                                          ...  \n",
       "ARTNIRMAN                                    107  \n",
       "AXISCADES                                   4159  \n",
       "TTML                                      708626  \n",
       "FOCUS                                        300  \n",
       "JPOLYINVST                                     0  \n",
       "\n",
       "[1502 rows x 25 columns]"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df4 = nse.pre_open()\n",
    "df4"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "3a1d8a49",
   "metadata": {},
   "outputs": [],
   "source": [
    "buffer = io.BytesIO()\n",
    "buffer.write(export_csv(df4).encode())\n",
    "buffer.seek(0)\n",
    "buffer.name = f'pre_open.csv'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "51689faf",
   "metadata": {},
   "outputs": [],
   "source": [
    "base_url = \"https://api.telegram.org/bot2116923117:AAFccongYIN7CJwXcIjMbtidduE6IiYEFuM/sendDocument\"\n",
    "\n",
    "parameters = {\n",
    "    \"chat_id\" : \"-777737632\",\n",
    "    \"caption\" : \"pre_open\"\n",
    "}\n",
    "\n",
    "files = {\n",
    "    \"document\" : buffer\n",
    "}\n",
    "\n",
    "resp = requests.get(base_url, data = parameters, files = files)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "084eb0ae",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>1</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>timestamp</td>\n",
       "      <td>24-Dec-2021 14:05:45</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>data</td>\n",
       "      <td>[{'session': 'Session 1', 'symbol': 'TCS', 'se...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>totalTradedValue</td>\n",
       "      <td>15094404515.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>totalTradedVolume</td>\n",
       "      <td>44343139</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Session 2</td>\n",
       "      <td>{'advances': 0, 'declines': 1, 'unchanged': 0}</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Session 1</td>\n",
       "      <td>{'advances': 1, 'declines': 0, 'unchanged': 0}</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>marketStatus</td>\n",
       "      <td>{'market': 'Capital Market', 'marketStatus': '...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                   0                                                  1\n",
       "0          timestamp                               24-Dec-2021 14:05:45\n",
       "1               data  [{'session': 'Session 1', 'symbol': 'TCS', 'se...\n",
       "2   totalTradedValue                                      15094404515.6\n",
       "3  totalTradedVolume                                           44343139\n",
       "4          Session 2     {'advances': 0, 'declines': 1, 'unchanged': 0}\n",
       "5          Session 1     {'advances': 1, 'declines': 0, 'unchanged': 0}\n",
       "6       marketStatus  {'market': 'Capital Market', 'marketStatus': '..."
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "A = nse_blockdeal()\n",
    "df5 = pd.DataFrame(A.items())\n",
    "df5"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "bbe50394",
   "metadata": {},
   "outputs": [],
   "source": [
    "buffer = io.BytesIO()\n",
    "buffer.write(export_csv(df5).encode())\n",
    "buffer.seek(0)\n",
    "buffer.name = f'nse_blockdeal.csv'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "2731e4a7",
   "metadata": {},
   "outputs": [],
   "source": [
    "base_url = \"https://api.telegram.org/bot2116923117:AAFccongYIN7CJwXcIjMbtidduE6IiYEFuM/sendDocument\"\n",
    "\n",
    "parameters = {\n",
    "    \"chat_id\" : \"-777737632\",\n",
    "    \"caption\" : \"pre_open\"\n",
    "}\n",
    "\n",
    "files = {\n",
    "    \"document\" : buffer\n",
    "}\n",
    "\n",
    "resp = requests.get(base_url, data = parameters, files = files)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "11480f33",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>category</th>\n",
       "      <th>date</th>\n",
       "      <th>buyValue</th>\n",
       "      <th>sellValue</th>\n",
       "      <th>netValue</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>DII **</td>\n",
       "      <td>24-Dec-2021</td>\n",
       "      <td>3909.5</td>\n",
       "      <td>3952.74</td>\n",
       "      <td>-43.24</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>FII/FPI *</td>\n",
       "      <td>24-Dec-2021</td>\n",
       "      <td>2360.05</td>\n",
       "      <td>3075.05</td>\n",
       "      <td>-715</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    category         date buyValue sellValue netValue\n",
       "0     DII **  24-Dec-2021   3909.5   3952.74   -43.24\n",
       "1  FII/FPI *  24-Dec-2021  2360.05   3075.05     -715"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df6 = nse_fiidii()\n",
    "df6"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "3b43c17d",
   "metadata": {},
   "outputs": [],
   "source": [
    "buffer = io.BytesIO()\n",
    "buffer.write(export_csv(df6).encode())\n",
    "buffer.seek(0)\n",
    "buffer.name = f'nse_fiidii.csv'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "52215dd8",
   "metadata": {},
   "outputs": [],
   "source": [
    "base_url = \"https://api.telegram.org/bot2116923117:AAFccongYIN7CJwXcIjMbtidduE6IiYEFuM/sendDocument\"\n",
    "\n",
    "parameters = {\n",
    "    \"chat_id\" : \"-777737632\",\n",
    "    \"caption\" : \"nse_fiidii\"\n",
    "}\n",
    "\n",
    "files = {\n",
    "    \"document\" : buffer\n",
    "}\n",
    "\n",
    "resp = requests.get(base_url, data = parameters, files = files)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "fdb5bb52",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>identifier</th>\n",
       "      <th>series</th>\n",
       "      <th>open</th>\n",
       "      <th>dayHigh</th>\n",
       "      <th>dayLow</th>\n",
       "      <th>lastPrice</th>\n",
       "      <th>previousClose</th>\n",
       "      <th>change</th>\n",
       "      <th>pChange</th>\n",
       "      <th>totalTradedVolume</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>symbol</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>FSL</th>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>175.95</td>\n",
       "      <td>185</td>\n",
       "      <td>172.35</td>\n",
       "      <td>182.8</td>\n",
       "      <td>175.05</td>\n",
       "      <td>7.75</td>\n",
       "      <td>4.43</td>\n",
       "      <td>20318025</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>COFORGE</th>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>5468</td>\n",
       "      <td>5668.75</td>\n",
       "      <td>5461.35</td>\n",
       "      <td>5638.5</td>\n",
       "      <td>5455.5</td>\n",
       "      <td>183.00</td>\n",
       "      <td>3.35</td>\n",
       "      <td>517808</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HCLTECH</th>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>1262.15</td>\n",
       "      <td>1283.8</td>\n",
       "      <td>1246.15</td>\n",
       "      <td>1262.6</td>\n",
       "      <td>1227.45</td>\n",
       "      <td>35.15</td>\n",
       "      <td>2.86</td>\n",
       "      <td>15952929</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>BALKRISIND</th>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>2168</td>\n",
       "      <td>2216.85</td>\n",
       "      <td>2151.3</td>\n",
       "      <td>2197</td>\n",
       "      <td>2143.95</td>\n",
       "      <td>53.05</td>\n",
       "      <td>2.47</td>\n",
       "      <td>497114</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>TECHM</th>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>1683.35</td>\n",
       "      <td>1735.2</td>\n",
       "      <td>1680.35</td>\n",
       "      <td>1724</td>\n",
       "      <td>1683.8</td>\n",
       "      <td>40.20</td>\n",
       "      <td>2.39</td>\n",
       "      <td>3343946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SBILIFE</th>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>1130.8</td>\n",
       "      <td>1153.65</td>\n",
       "      <td>1126</td>\n",
       "      <td>1148</td>\n",
       "      <td>1125.45</td>\n",
       "      <td>22.55</td>\n",
       "      <td>2.00</td>\n",
       "      <td>1930715</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LTI</th>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>7071</td>\n",
       "      <td>7185</td>\n",
       "      <td>7070</td>\n",
       "      <td>7170</td>\n",
       "      <td>7033.5</td>\n",
       "      <td>136.50</td>\n",
       "      <td>1.94</td>\n",
       "      <td>363446</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>METROPOLIS</th>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>3274.8</td>\n",
       "      <td>3319.7</td>\n",
       "      <td>3183.15</td>\n",
       "      <td>3295</td>\n",
       "      <td>3242.3</td>\n",
       "      <td>52.70</td>\n",
       "      <td>1.63</td>\n",
       "      <td>174929</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ADANIENT</th>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>1680</td>\n",
       "      <td>1703.95</td>\n",
       "      <td>1658.2</td>\n",
       "      <td>1694.45</td>\n",
       "      <td>1676.2</td>\n",
       "      <td>18.25</td>\n",
       "      <td>1.09</td>\n",
       "      <td>1234386</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>DIXON</th>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>5388</td>\n",
       "      <td>5469</td>\n",
       "      <td>5384.95</td>\n",
       "      <td>5423</td>\n",
       "      <td>5369.1</td>\n",
       "      <td>53.90</td>\n",
       "      <td>1.00</td>\n",
       "      <td>343496</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "           identifier series     open  dayHigh   dayLow lastPrice  \\\n",
       "symbol                                                              \n",
       "FSL                       EQ   175.95      185   172.35     182.8   \n",
       "COFORGE                   EQ     5468  5668.75  5461.35    5638.5   \n",
       "HCLTECH                   EQ  1262.15   1283.8  1246.15    1262.6   \n",
       "BALKRISIND                EQ     2168  2216.85   2151.3      2197   \n",
       "TECHM                     EQ  1683.35   1735.2  1680.35      1724   \n",
       "SBILIFE                   EQ   1130.8  1153.65     1126      1148   \n",
       "LTI                       EQ     7071     7185     7070      7170   \n",
       "METROPOLIS                EQ   3274.8   3319.7  3183.15      3295   \n",
       "ADANIENT                  EQ     1680  1703.95   1658.2   1694.45   \n",
       "DIXON                     EQ     5388     5469  5384.95      5423   \n",
       "\n",
       "           previousClose  change  pChange  totalTradedVolume  \n",
       "symbol                                                        \n",
       "FSL               175.05    7.75     4.43           20318025  \n",
       "COFORGE           5455.5  183.00     3.35             517808  \n",
       "HCLTECH          1227.45   35.15     2.86           15952929  \n",
       "BALKRISIND       2143.95   53.05     2.47             497114  \n",
       "TECHM             1683.8   40.20     2.39            3343946  \n",
       "SBILIFE          1125.45   22.55     2.00            1930715  \n",
       "LTI               7033.5  136.50     1.94             363446  \n",
       "METROPOLIS        3242.3   52.70     1.63             174929  \n",
       "ADANIENT          1676.2   18.25     1.09            1234386  \n",
       "DIXON             5369.1   53.90     1.00             343496  "
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df7 = nse.top_gainers(index=IndexSymbol.FnO, length=10)\n",
    "df7"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "82aa2c53",
   "metadata": {},
   "outputs": [],
   "source": [
    "buffer = io.BytesIO()\n",
    "buffer.write(export_csv(df7).encode())\n",
    "buffer.seek(0)\n",
    "buffer.name = f'top_gainers.csv'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "99531e66",
   "metadata": {},
   "outputs": [],
   "source": [
    "base_url = \"https://api.telegram.org/bot2116923117:AAFccongYIN7CJwXcIjMbtidduE6IiYEFuM/sendDocument\"\n",
    "\n",
    "parameters = {\n",
    "    \"chat_id\" : \"-777737632\",\n",
    "    \"caption\" : \"top_gainers\"\n",
    "}\n",
    "\n",
    "files = {\n",
    "    \"document\" : buffer\n",
    "}\n",
    "\n",
    "resp = requests.get(base_url, data = parameters, files = files)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "b76a6a49",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>identifier</th>\n",
       "      <th>series</th>\n",
       "      <th>open</th>\n",
       "      <th>dayHigh</th>\n",
       "      <th>dayLow</th>\n",
       "      <th>lastPrice</th>\n",
       "      <th>previousClose</th>\n",
       "      <th>change</th>\n",
       "      <th>pChange</th>\n",
       "      <th>totalTradedVolume</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>symbol</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>L&amp;TFH</th>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>83</td>\n",
       "      <td>83</td>\n",
       "      <td>76.65</td>\n",
       "      <td>77.1</td>\n",
       "      <td>82.6</td>\n",
       "      <td>-5.50</td>\n",
       "      <td>-6.66</td>\n",
       "      <td>31197648</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>BIOCON</th>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>363</td>\n",
       "      <td>366</td>\n",
       "      <td>352.5</td>\n",
       "      <td>354.55</td>\n",
       "      <td>374.35</td>\n",
       "      <td>-19.80</td>\n",
       "      <td>-5.29</td>\n",
       "      <td>7151655</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>TORNTPHARM</th>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>3180</td>\n",
       "      <td>3199</td>\n",
       "      <td>3036.35</td>\n",
       "      <td>3040</td>\n",
       "      <td>3162.5</td>\n",
       "      <td>-122.50</td>\n",
       "      <td>-3.87</td>\n",
       "      <td>280601</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SYNGENE</th>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>613.6</td>\n",
       "      <td>613.6</td>\n",
       "      <td>589.5</td>\n",
       "      <td>589.9</td>\n",
       "      <td>613.6</td>\n",
       "      <td>-23.70</td>\n",
       "      <td>-3.86</td>\n",
       "      <td>448429</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CHOLAFIN</th>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>541</td>\n",
       "      <td>542</td>\n",
       "      <td>517.65</td>\n",
       "      <td>519.85</td>\n",
       "      <td>539.65</td>\n",
       "      <td>-19.80</td>\n",
       "      <td>-3.67</td>\n",
       "      <td>1838454</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>DELTACORP</th>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>273</td>\n",
       "      <td>273.5</td>\n",
       "      <td>260.15</td>\n",
       "      <td>263.9</td>\n",
       "      <td>273.5</td>\n",
       "      <td>-9.60</td>\n",
       "      <td>-3.51</td>\n",
       "      <td>4466041</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>M&amp;MFIN</th>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>152</td>\n",
       "      <td>153.6</td>\n",
       "      <td>144.3</td>\n",
       "      <td>145.45</td>\n",
       "      <td>150.55</td>\n",
       "      <td>-5.10</td>\n",
       "      <td>-3.39</td>\n",
       "      <td>5628542</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CONCOR</th>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>626.7</td>\n",
       "      <td>626.8</td>\n",
       "      <td>600.5</td>\n",
       "      <td>602.15</td>\n",
       "      <td>622.4</td>\n",
       "      <td>-20.25</td>\n",
       "      <td>-3.25</td>\n",
       "      <td>1114790</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CANBK</th>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>201.7</td>\n",
       "      <td>201.9</td>\n",
       "      <td>193</td>\n",
       "      <td>194.25</td>\n",
       "      <td>200.5</td>\n",
       "      <td>-6.25</td>\n",
       "      <td>-3.12</td>\n",
       "      <td>10186277</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CHAMBLFERT</th>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>393.5</td>\n",
       "      <td>394.9</td>\n",
       "      <td>379.7</td>\n",
       "      <td>380.75</td>\n",
       "      <td>392.8</td>\n",
       "      <td>-12.05</td>\n",
       "      <td>-3.07</td>\n",
       "      <td>1754054</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "           identifier series   open dayHigh   dayLow lastPrice previousClose  \\\n",
       "symbol                                                                         \n",
       "L&TFH                     EQ     83      83    76.65      77.1          82.6   \n",
       "BIOCON                    EQ    363     366    352.5    354.55        374.35   \n",
       "TORNTPHARM                EQ   3180    3199  3036.35      3040        3162.5   \n",
       "SYNGENE                   EQ  613.6   613.6    589.5     589.9         613.6   \n",
       "CHOLAFIN                  EQ    541     542   517.65    519.85        539.65   \n",
       "DELTACORP                 EQ    273   273.5   260.15     263.9         273.5   \n",
       "M&MFIN                    EQ    152   153.6    144.3    145.45        150.55   \n",
       "CONCOR                    EQ  626.7   626.8    600.5    602.15         622.4   \n",
       "CANBK                     EQ  201.7   201.9      193    194.25         200.5   \n",
       "CHAMBLFERT                EQ  393.5   394.9    379.7    380.75         392.8   \n",
       "\n",
       "            change  pChange  totalTradedVolume  \n",
       "symbol                                          \n",
       "L&TFH        -5.50    -6.66           31197648  \n",
       "BIOCON      -19.80    -5.29            7151655  \n",
       "TORNTPHARM -122.50    -3.87             280601  \n",
       "SYNGENE     -23.70    -3.86             448429  \n",
       "CHOLAFIN    -19.80    -3.67            1838454  \n",
       "DELTACORP    -9.60    -3.51            4466041  \n",
       "M&MFIN       -5.10    -3.39            5628542  \n",
       "CONCOR      -20.25    -3.25            1114790  \n",
       "CANBK        -6.25    -3.12           10186277  \n",
       "CHAMBLFERT  -12.05    -3.07            1754054  "
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df8 = nse.top_losers(index=IndexSymbol.FnO, length=10)\n",
    "df8"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "aba5e070",
   "metadata": {},
   "outputs": [],
   "source": [
    "buffer = io.BytesIO()\n",
    "buffer.write(export_csv(df8).encode())\n",
    "buffer.seek(0)\n",
    "buffer.name = f'top_losers.csv'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "c24edd8b",
   "metadata": {},
   "outputs": [],
   "source": [
    "base_url = \"https://api.telegram.org/bot2116923117:AAFccongYIN7CJwXcIjMbtidduE6IiYEFuM/sendDocument\"\n",
    "\n",
    "parameters = {\n",
    "    \"chat_id\" : \"-777737632\",\n",
    "    \"caption\" : \"top_losers\"\n",
    "}\n",
    "\n",
    "files = {\n",
    "    \"document\" : buffer\n",
    "}\n",
    "\n",
    "resp = requests.get(base_url, data = parameters, files = files)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "3e565fc6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>symbol</th>\n",
       "      <th>identifier</th>\n",
       "      <th>series</th>\n",
       "      <th>open</th>\n",
       "      <th>dayHigh</th>\n",
       "      <th>dayLow</th>\n",
       "      <th>lastPrice</th>\n",
       "      <th>previousClose</th>\n",
       "      <th>change</th>\n",
       "      <th>pChange</th>\n",
       "      <th>...</th>\n",
       "      <th>nearWKH</th>\n",
       "      <th>nearWKL</th>\n",
       "      <th>perChange365d</th>\n",
       "      <th>date365dAgo</th>\n",
       "      <th>chart365dPath</th>\n",
       "      <th>date30dAgo</th>\n",
       "      <th>perChange30d</th>\n",
       "      <th>chart30dPath</th>\n",
       "      <th>chartTodayPath</th>\n",
       "      <th>meta</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>FSL</td>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>175.95</td>\n",
       "      <td>185</td>\n",
       "      <td>172.35</td>\n",
       "      <td>182.8</td>\n",
       "      <td>175.05</td>\n",
       "      <td>7.75</td>\n",
       "      <td>4.43</td>\n",
       "      <td>...</td>\n",
       "      <td>24.727198</td>\n",
       "      <td>-137.402597</td>\n",
       "      <td>99.62</td>\n",
       "      <td>24-Dec-2020</td>\n",
       "      <td>https://static.nseindia.com/sparklines/365d/FS...</td>\n",
       "      <td>25-Nov-2021</td>\n",
       "      <td>6.69</td>\n",
       "      <td>https://static.nseindia.com/sparklines/30d/FSL...</td>\n",
       "      <td>https://static.nseindia.com/sparklines/today/F...</td>\n",
       "      <td>{'symbol': 'FSL', 'companyName': 'Firstsource ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>COFORGE</td>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>5468</td>\n",
       "      <td>5668.75</td>\n",
       "      <td>5461.35</td>\n",
       "      <td>5638.5</td>\n",
       "      <td>5455.5</td>\n",
       "      <td>183.00</td>\n",
       "      <td>3.35</td>\n",
       "      <td>...</td>\n",
       "      <td>6.492537</td>\n",
       "      <td>-145.152174</td>\n",
       "      <td>112.84</td>\n",
       "      <td>24-Dec-2020</td>\n",
       "      <td>https://static.nseindia.com/sparklines/365d/CO...</td>\n",
       "      <td>25-Nov-2021</td>\n",
       "      <td>2.60</td>\n",
       "      <td>https://static.nseindia.com/sparklines/30d/COF...</td>\n",
       "      <td>https://static.nseindia.com/sparklines/today/C...</td>\n",
       "      <td>{'symbol': 'COFORGE', 'companyName': 'Coforge ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>HCLTECH</td>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>1262.15</td>\n",
       "      <td>1283.8</td>\n",
       "      <td>1246.15</td>\n",
       "      <td>1262.6</td>\n",
       "      <td>1227.45</td>\n",
       "      <td>35.15</td>\n",
       "      <td>2.86</td>\n",
       "      <td>...</td>\n",
       "      <td>8.357830</td>\n",
       "      <td>-41.705948</td>\n",
       "      <td>37.62</td>\n",
       "      <td>24-Dec-2020</td>\n",
       "      <td>https://static.nseindia.com/sparklines/365d/HC...</td>\n",
       "      <td>25-Nov-2021</td>\n",
       "      <td>12.48</td>\n",
       "      <td>https://static.nseindia.com/sparklines/30d/HCL...</td>\n",
       "      <td>https://static.nseindia.com/sparklines/today/H...</td>\n",
       "      <td>{'symbol': 'HCLTECH', 'companyName': 'HCL Tech...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>BALKRISIND</td>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>2168</td>\n",
       "      <td>2216.85</td>\n",
       "      <td>2151.3</td>\n",
       "      <td>2197</td>\n",
       "      <td>2143.95</td>\n",
       "      <td>53.05</td>\n",
       "      <td>2.47</td>\n",
       "      <td>...</td>\n",
       "      <td>19.340627</td>\n",
       "      <td>-44.858735</td>\n",
       "      <td>41.57</td>\n",
       "      <td>24-Dec-2020</td>\n",
       "      <td>https://static.nseindia.com/sparklines/365d/BA...</td>\n",
       "      <td>25-Nov-2021</td>\n",
       "      <td>-1.72</td>\n",
       "      <td>https://static.nseindia.com/sparklines/30d/BAL...</td>\n",
       "      <td>https://static.nseindia.com/sparklines/today/B...</td>\n",
       "      <td>{'symbol': 'BALKRISIND', 'companyName': 'Balkr...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>TECHM</td>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>1683.35</td>\n",
       "      <td>1735.2</td>\n",
       "      <td>1680.35</td>\n",
       "      <td>1724</td>\n",
       "      <td>1683.8</td>\n",
       "      <td>40.20</td>\n",
       "      <td>2.39</td>\n",
       "      <td>...</td>\n",
       "      <td>0.645459</td>\n",
       "      <td>-88.415301</td>\n",
       "      <td>81.98</td>\n",
       "      <td>24-Dec-2020</td>\n",
       "      <td>https://static.nseindia.com/sparklines/365d/TE...</td>\n",
       "      <td>25-Nov-2021</td>\n",
       "      <td>10.55</td>\n",
       "      <td>https://static.nseindia.com/sparklines/30d/TEC...</td>\n",
       "      <td>https://static.nseindia.com/sparklines/today/T...</td>\n",
       "      <td>{'symbol': 'TECHM', 'companyName': 'Tech Mahin...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       symbol identifier series     open  dayHigh   dayLow lastPrice  \\\n",
       "0         FSL                EQ   175.95      185   172.35     182.8   \n",
       "1     COFORGE                EQ     5468  5668.75  5461.35    5638.5   \n",
       "2     HCLTECH                EQ  1262.15   1283.8  1246.15    1262.6   \n",
       "3  BALKRISIND                EQ     2168  2216.85   2151.3      2197   \n",
       "4       TECHM                EQ  1683.35   1735.2  1680.35      1724   \n",
       "\n",
       "  previousClose  change  pChange  ...    nearWKH     nearWKL perChange365d  \\\n",
       "0        175.05    7.75     4.43  ...  24.727198 -137.402597         99.62   \n",
       "1        5455.5  183.00     3.35  ...   6.492537 -145.152174        112.84   \n",
       "2       1227.45   35.15     2.86  ...   8.357830  -41.705948         37.62   \n",
       "3       2143.95   53.05     2.47  ...  19.340627  -44.858735         41.57   \n",
       "4        1683.8   40.20     2.39  ...   0.645459  -88.415301         81.98   \n",
       "\n",
       "   date365dAgo                                      chart365dPath  \\\n",
       "0  24-Dec-2020  https://static.nseindia.com/sparklines/365d/FS...   \n",
       "1  24-Dec-2020  https://static.nseindia.com/sparklines/365d/CO...   \n",
       "2  24-Dec-2020  https://static.nseindia.com/sparklines/365d/HC...   \n",
       "3  24-Dec-2020  https://static.nseindia.com/sparklines/365d/BA...   \n",
       "4  24-Dec-2020  https://static.nseindia.com/sparklines/365d/TE...   \n",
       "\n",
       "    date30dAgo  perChange30d  \\\n",
       "0  25-Nov-2021          6.69   \n",
       "1  25-Nov-2021          2.60   \n",
       "2  25-Nov-2021         12.48   \n",
       "3  25-Nov-2021         -1.72   \n",
       "4  25-Nov-2021         10.55   \n",
       "\n",
       "                                        chart30dPath  \\\n",
       "0  https://static.nseindia.com/sparklines/30d/FSL...   \n",
       "1  https://static.nseindia.com/sparklines/30d/COF...   \n",
       "2  https://static.nseindia.com/sparklines/30d/HCL...   \n",
       "3  https://static.nseindia.com/sparklines/30d/BAL...   \n",
       "4  https://static.nseindia.com/sparklines/30d/TEC...   \n",
       "\n",
       "                                      chartTodayPath  \\\n",
       "0  https://static.nseindia.com/sparklines/today/F...   \n",
       "1  https://static.nseindia.com/sparklines/today/C...   \n",
       "2  https://static.nseindia.com/sparklines/today/H...   \n",
       "3  https://static.nseindia.com/sparklines/today/B...   \n",
       "4  https://static.nseindia.com/sparklines/today/T...   \n",
       "\n",
       "                                                meta  \n",
       "0  {'symbol': 'FSL', 'companyName': 'Firstsource ...  \n",
       "1  {'symbol': 'COFORGE', 'companyName': 'Coforge ...  \n",
       "2  {'symbol': 'HCLTECH', 'companyName': 'HCL Tech...  \n",
       "3  {'symbol': 'BALKRISIND', 'companyName': 'Balkr...  \n",
       "4  {'symbol': 'TECHM', 'companyName': 'Tech Mahin...  \n",
       "\n",
       "[5 rows x 25 columns]"
      ]
     },
     "execution_count": 37,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df9 = nse_get_top_gainers()\n",
    "df9"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "439fe2c0",
   "metadata": {},
   "outputs": [],
   "source": [
    "buffer = io.BytesIO()\n",
    "buffer.write(export_csv(df9).encode())\n",
    "buffer.seek(0)\n",
    "buffer.name = f'nse_get_top_gainers.csv'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "2136014e",
   "metadata": {},
   "outputs": [],
   "source": [
    "base_url = \"https://api.telegram.org/bot2116923117:AAFccongYIN7CJwXcIjMbtidduE6IiYEFuM/sendDocument\"\n",
    "\n",
    "parameters = {\n",
    "    \"chat_id\" : \"-777737632\",\n",
    "    \"caption\" : \"nse_get_top_gainers\"\n",
    "}\n",
    "\n",
    "files = {\n",
    "    \"document\" : buffer\n",
    "}\n",
    "\n",
    "resp = requests.get(base_url, data = parameters, files = files)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "3438a622",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>symbol</th>\n",
       "      <th>identifier</th>\n",
       "      <th>series</th>\n",
       "      <th>open</th>\n",
       "      <th>dayHigh</th>\n",
       "      <th>dayLow</th>\n",
       "      <th>lastPrice</th>\n",
       "      <th>previousClose</th>\n",
       "      <th>change</th>\n",
       "      <th>pChange</th>\n",
       "      <th>...</th>\n",
       "      <th>nearWKH</th>\n",
       "      <th>nearWKL</th>\n",
       "      <th>perChange365d</th>\n",
       "      <th>date365dAgo</th>\n",
       "      <th>chart365dPath</th>\n",
       "      <th>date30dAgo</th>\n",
       "      <th>perChange30d</th>\n",
       "      <th>chart30dPath</th>\n",
       "      <th>chartTodayPath</th>\n",
       "      <th>meta</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>187</th>\n",
       "      <td>L&amp;TFH</td>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>83</td>\n",
       "      <td>83</td>\n",
       "      <td>76.65</td>\n",
       "      <td>77.1</td>\n",
       "      <td>82.6</td>\n",
       "      <td>-5.5</td>\n",
       "      <td>-6.66</td>\n",
       "      <td>...</td>\n",
       "      <td>32.010582</td>\n",
       "      <td>-7.832168</td>\n",
       "      <td>-14.93</td>\n",
       "      <td>24-Dec-2020</td>\n",
       "      <td>https://static.nseindia.com/sparklines/365d/L&amp;...</td>\n",
       "      <td>25-Nov-2021</td>\n",
       "      <td>-2.66</td>\n",
       "      <td>https://static.nseindia.com/sparklines/30d/L&amp;T...</td>\n",
       "      <td>https://static.nseindia.com/sparklines/today/L...</td>\n",
       "      <td>{'symbol': 'L&amp;TFH', 'companyName': 'L&amp;T Financ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>186</th>\n",
       "      <td>BIOCON</td>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>363</td>\n",
       "      <td>366</td>\n",
       "      <td>352.5</td>\n",
       "      <td>354.55</td>\n",
       "      <td>374.35</td>\n",
       "      <td>-19.8</td>\n",
       "      <td>-5.29</td>\n",
       "      <td>...</td>\n",
       "      <td>27.309072</td>\n",
       "      <td>-12.627065</td>\n",
       "      <td>-26.46</td>\n",
       "      <td>24-Dec-2020</td>\n",
       "      <td>https://static.nseindia.com/sparklines/365d/BI...</td>\n",
       "      <td>25-Nov-2021</td>\n",
       "      <td>-2.22</td>\n",
       "      <td>https://static.nseindia.com/sparklines/30d/BIO...</td>\n",
       "      <td>https://static.nseindia.com/sparklines/today/B...</td>\n",
       "      <td>{'symbol': 'BIOCON', 'companyName': 'Biocon Li...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>185</th>\n",
       "      <td>TORNTPHARM</td>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>3180</td>\n",
       "      <td>3199</td>\n",
       "      <td>3036.35</td>\n",
       "      <td>3040</td>\n",
       "      <td>3162.5</td>\n",
       "      <td>-122.5</td>\n",
       "      <td>-3.87</td>\n",
       "      <td>...</td>\n",
       "      <td>6.467294</td>\n",
       "      <td>-31.539094</td>\n",
       "      <td>9.37</td>\n",
       "      <td>24-Dec-2020</td>\n",
       "      <td>https://static.nseindia.com/sparklines/365d/TO...</td>\n",
       "      <td>25-Nov-2021</td>\n",
       "      <td>1.86</td>\n",
       "      <td>https://static.nseindia.com/sparklines/30d/TOR...</td>\n",
       "      <td>https://static.nseindia.com/sparklines/today/T...</td>\n",
       "      <td>{'symbol': 'TORNTPHARM', 'companyName': 'Torre...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>184</th>\n",
       "      <td>SYNGENE</td>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>613.6</td>\n",
       "      <td>613.6</td>\n",
       "      <td>589.5</td>\n",
       "      <td>589.9</td>\n",
       "      <td>613.6</td>\n",
       "      <td>-23.7</td>\n",
       "      <td>-3.86</td>\n",
       "      <td>...</td>\n",
       "      <td>15.728571</td>\n",
       "      <td>-20.265036</td>\n",
       "      <td>-3.19</td>\n",
       "      <td>24-Dec-2020</td>\n",
       "      <td>https://static.nseindia.com/sparklines/365d/SY...</td>\n",
       "      <td>25-Nov-2021</td>\n",
       "      <td>0.42</td>\n",
       "      <td>https://static.nseindia.com/sparklines/30d/SYN...</td>\n",
       "      <td>https://static.nseindia.com/sparklines/today/S...</td>\n",
       "      <td>{'symbol': 'SYNGENE', 'companyName': 'Syngene ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183</th>\n",
       "      <td>CHOLAFIN</td>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>541</td>\n",
       "      <td>542</td>\n",
       "      <td>517.65</td>\n",
       "      <td>519.85</td>\n",
       "      <td>539.65</td>\n",
       "      <td>-19.8</td>\n",
       "      <td>-3.67</td>\n",
       "      <td>...</td>\n",
       "      <td>22.108181</td>\n",
       "      <td>-45.087915</td>\n",
       "      <td>38.18</td>\n",
       "      <td>24-Dec-2020</td>\n",
       "      <td>https://static.nseindia.com/sparklines/365d/CH...</td>\n",
       "      <td>25-Nov-2021</td>\n",
       "      <td>-11.00</td>\n",
       "      <td>https://static.nseindia.com/sparklines/30d/CHO...</td>\n",
       "      <td>https://static.nseindia.com/sparklines/today/C...</td>\n",
       "      <td>{'symbol': 'CHOLAFIN', 'companyName': 'Cholama...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         symbol identifier series   open dayHigh   dayLow lastPrice  \\\n",
       "187       L&TFH                EQ     83      83    76.65      77.1   \n",
       "186      BIOCON                EQ    363     366    352.5    354.55   \n",
       "185  TORNTPHARM                EQ   3180    3199  3036.35      3040   \n",
       "184     SYNGENE                EQ  613.6   613.6    589.5     589.9   \n",
       "183    CHOLAFIN                EQ    541     542   517.65    519.85   \n",
       "\n",
       "    previousClose  change  pChange  ...    nearWKH    nearWKL perChange365d  \\\n",
       "187          82.6    -5.5    -6.66  ...  32.010582  -7.832168        -14.93   \n",
       "186        374.35   -19.8    -5.29  ...  27.309072 -12.627065        -26.46   \n",
       "185        3162.5  -122.5    -3.87  ...   6.467294 -31.539094          9.37   \n",
       "184         613.6   -23.7    -3.86  ...  15.728571 -20.265036         -3.19   \n",
       "183        539.65   -19.8    -3.67  ...  22.108181 -45.087915         38.18   \n",
       "\n",
       "     date365dAgo                                      chart365dPath  \\\n",
       "187  24-Dec-2020  https://static.nseindia.com/sparklines/365d/L&...   \n",
       "186  24-Dec-2020  https://static.nseindia.com/sparklines/365d/BI...   \n",
       "185  24-Dec-2020  https://static.nseindia.com/sparklines/365d/TO...   \n",
       "184  24-Dec-2020  https://static.nseindia.com/sparklines/365d/SY...   \n",
       "183  24-Dec-2020  https://static.nseindia.com/sparklines/365d/CH...   \n",
       "\n",
       "      date30dAgo  perChange30d  \\\n",
       "187  25-Nov-2021         -2.66   \n",
       "186  25-Nov-2021         -2.22   \n",
       "185  25-Nov-2021          1.86   \n",
       "184  25-Nov-2021          0.42   \n",
       "183  25-Nov-2021        -11.00   \n",
       "\n",
       "                                          chart30dPath  \\\n",
       "187  https://static.nseindia.com/sparklines/30d/L&T...   \n",
       "186  https://static.nseindia.com/sparklines/30d/BIO...   \n",
       "185  https://static.nseindia.com/sparklines/30d/TOR...   \n",
       "184  https://static.nseindia.com/sparklines/30d/SYN...   \n",
       "183  https://static.nseindia.com/sparklines/30d/CHO...   \n",
       "\n",
       "                                        chartTodayPath  \\\n",
       "187  https://static.nseindia.com/sparklines/today/L...   \n",
       "186  https://static.nseindia.com/sparklines/today/B...   \n",
       "185  https://static.nseindia.com/sparklines/today/T...   \n",
       "184  https://static.nseindia.com/sparklines/today/S...   \n",
       "183  https://static.nseindia.com/sparklines/today/C...   \n",
       "\n",
       "                                                  meta  \n",
       "187  {'symbol': 'L&TFH', 'companyName': 'L&T Financ...  \n",
       "186  {'symbol': 'BIOCON', 'companyName': 'Biocon Li...  \n",
       "185  {'symbol': 'TORNTPHARM', 'companyName': 'Torre...  \n",
       "184  {'symbol': 'SYNGENE', 'companyName': 'Syngene ...  \n",
       "183  {'symbol': 'CHOLAFIN', 'companyName': 'Cholama...  \n",
       "\n",
       "[5 rows x 25 columns]"
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df10 = nse_get_top_losers()\n",
    "df10"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "e23045c8",
   "metadata": {},
   "outputs": [],
   "source": [
    "buffer = io.BytesIO()\n",
    "buffer.write(export_csv(df10).encode())\n",
    "buffer.seek(0)\n",
    "buffer.name = f'nse_get_top_losers.csv'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "3aa2e513",
   "metadata": {},
   "outputs": [],
   "source": [
    "base_url = \"https://api.telegram.org/bot2116923117:AAFccongYIN7CJwXcIjMbtidduE6IiYEFuM/sendDocument\"\n",
    "\n",
    "parameters = {\n",
    "    \"chat_id\" : \"-777737632\",\n",
    "    \"caption\" : \"nse_get_top_losers\"\n",
    "}\n",
    "\n",
    "files = {\n",
    "    \"document\" : buffer\n",
    "}\n",
    "\n",
    "resp = requests.get(base_url, data = parameters, files = files)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "bfc9f0ef",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>symbol</th>\n",
       "      <th>identifier</th>\n",
       "      <th>series</th>\n",
       "      <th>open</th>\n",
       "      <th>dayHigh</th>\n",
       "      <th>dayLow</th>\n",
       "      <th>lastPrice</th>\n",
       "      <th>previousClose</th>\n",
       "      <th>change</th>\n",
       "      <th>pChange</th>\n",
       "      <th>...</th>\n",
       "      <th>nearWKH</th>\n",
       "      <th>nearWKL</th>\n",
       "      <th>perChange365d</th>\n",
       "      <th>date365dAgo</th>\n",
       "      <th>chart365dPath</th>\n",
       "      <th>date30dAgo</th>\n",
       "      <th>perChange30d</th>\n",
       "      <th>chart30dPath</th>\n",
       "      <th>chartTodayPath</th>\n",
       "      <th>meta</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>FSL</td>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>175.95</td>\n",
       "      <td>185</td>\n",
       "      <td>172.35</td>\n",
       "      <td>182.8</td>\n",
       "      <td>175.05</td>\n",
       "      <td>7.75</td>\n",
       "      <td>4.43</td>\n",
       "      <td>...</td>\n",
       "      <td>24.727198</td>\n",
       "      <td>-137.402597</td>\n",
       "      <td>99.62</td>\n",
       "      <td>24-Dec-2020</td>\n",
       "      <td>https://static.nseindia.com/sparklines/365d/FS...</td>\n",
       "      <td>25-Nov-2021</td>\n",
       "      <td>6.69</td>\n",
       "      <td>https://static.nseindia.com/sparklines/30d/FSL...</td>\n",
       "      <td>https://static.nseindia.com/sparklines/today/F...</td>\n",
       "      <td>{'symbol': 'FSL', 'companyName': 'Firstsource ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>COFORGE</td>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>5468</td>\n",
       "      <td>5668.75</td>\n",
       "      <td>5461.35</td>\n",
       "      <td>5638.5</td>\n",
       "      <td>5455.5</td>\n",
       "      <td>183.00</td>\n",
       "      <td>3.35</td>\n",
       "      <td>...</td>\n",
       "      <td>6.492537</td>\n",
       "      <td>-145.152174</td>\n",
       "      <td>112.84</td>\n",
       "      <td>24-Dec-2020</td>\n",
       "      <td>https://static.nseindia.com/sparklines/365d/CO...</td>\n",
       "      <td>25-Nov-2021</td>\n",
       "      <td>2.60</td>\n",
       "      <td>https://static.nseindia.com/sparklines/30d/COF...</td>\n",
       "      <td>https://static.nseindia.com/sparklines/today/C...</td>\n",
       "      <td>{'symbol': 'COFORGE', 'companyName': 'Coforge ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>HCLTECH</td>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>1262.15</td>\n",
       "      <td>1283.8</td>\n",
       "      <td>1246.15</td>\n",
       "      <td>1262.6</td>\n",
       "      <td>1227.45</td>\n",
       "      <td>35.15</td>\n",
       "      <td>2.86</td>\n",
       "      <td>...</td>\n",
       "      <td>8.357830</td>\n",
       "      <td>-41.705948</td>\n",
       "      <td>37.62</td>\n",
       "      <td>24-Dec-2020</td>\n",
       "      <td>https://static.nseindia.com/sparklines/365d/HC...</td>\n",
       "      <td>25-Nov-2021</td>\n",
       "      <td>12.48</td>\n",
       "      <td>https://static.nseindia.com/sparklines/30d/HCL...</td>\n",
       "      <td>https://static.nseindia.com/sparklines/today/H...</td>\n",
       "      <td>{'symbol': 'HCLTECH', 'companyName': 'HCL Tech...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>BALKRISIND</td>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>2168</td>\n",
       "      <td>2216.85</td>\n",
       "      <td>2151.3</td>\n",
       "      <td>2197</td>\n",
       "      <td>2143.95</td>\n",
       "      <td>53.05</td>\n",
       "      <td>2.47</td>\n",
       "      <td>...</td>\n",
       "      <td>19.340627</td>\n",
       "      <td>-44.858735</td>\n",
       "      <td>41.57</td>\n",
       "      <td>24-Dec-2020</td>\n",
       "      <td>https://static.nseindia.com/sparklines/365d/BA...</td>\n",
       "      <td>25-Nov-2021</td>\n",
       "      <td>-1.72</td>\n",
       "      <td>https://static.nseindia.com/sparklines/30d/BAL...</td>\n",
       "      <td>https://static.nseindia.com/sparklines/today/B...</td>\n",
       "      <td>{'symbol': 'BALKRISIND', 'companyName': 'Balkr...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>TECHM</td>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>1683.35</td>\n",
       "      <td>1735.2</td>\n",
       "      <td>1680.35</td>\n",
       "      <td>1724</td>\n",
       "      <td>1683.8</td>\n",
       "      <td>40.20</td>\n",
       "      <td>2.39</td>\n",
       "      <td>...</td>\n",
       "      <td>0.645459</td>\n",
       "      <td>-88.415301</td>\n",
       "      <td>81.98</td>\n",
       "      <td>24-Dec-2020</td>\n",
       "      <td>https://static.nseindia.com/sparklines/365d/TE...</td>\n",
       "      <td>25-Nov-2021</td>\n",
       "      <td>10.55</td>\n",
       "      <td>https://static.nseindia.com/sparklines/30d/TEC...</td>\n",
       "      <td>https://static.nseindia.com/sparklines/today/T...</td>\n",
       "      <td>{'symbol': 'TECHM', 'companyName': 'Tech Mahin...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183</th>\n",
       "      <td>CHOLAFIN</td>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>541</td>\n",
       "      <td>542</td>\n",
       "      <td>517.65</td>\n",
       "      <td>519.85</td>\n",
       "      <td>539.65</td>\n",
       "      <td>-19.80</td>\n",
       "      <td>-3.67</td>\n",
       "      <td>...</td>\n",
       "      <td>22.108181</td>\n",
       "      <td>-45.087915</td>\n",
       "      <td>38.18</td>\n",
       "      <td>24-Dec-2020</td>\n",
       "      <td>https://static.nseindia.com/sparklines/365d/CH...</td>\n",
       "      <td>25-Nov-2021</td>\n",
       "      <td>-11.00</td>\n",
       "      <td>https://static.nseindia.com/sparklines/30d/CHO...</td>\n",
       "      <td>https://static.nseindia.com/sparklines/today/C...</td>\n",
       "      <td>{'symbol': 'CHOLAFIN', 'companyName': 'Cholama...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>184</th>\n",
       "      <td>SYNGENE</td>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>613.6</td>\n",
       "      <td>613.6</td>\n",
       "      <td>589.5</td>\n",
       "      <td>589.9</td>\n",
       "      <td>613.6</td>\n",
       "      <td>-23.70</td>\n",
       "      <td>-3.86</td>\n",
       "      <td>...</td>\n",
       "      <td>15.728571</td>\n",
       "      <td>-20.265036</td>\n",
       "      <td>-3.19</td>\n",
       "      <td>24-Dec-2020</td>\n",
       "      <td>https://static.nseindia.com/sparklines/365d/SY...</td>\n",
       "      <td>25-Nov-2021</td>\n",
       "      <td>0.42</td>\n",
       "      <td>https://static.nseindia.com/sparklines/30d/SYN...</td>\n",
       "      <td>https://static.nseindia.com/sparklines/today/S...</td>\n",
       "      <td>{'symbol': 'SYNGENE', 'companyName': 'Syngene ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>185</th>\n",
       "      <td>TORNTPHARM</td>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>3180</td>\n",
       "      <td>3199</td>\n",
       "      <td>3036.35</td>\n",
       "      <td>3040</td>\n",
       "      <td>3162.5</td>\n",
       "      <td>-122.50</td>\n",
       "      <td>-3.87</td>\n",
       "      <td>...</td>\n",
       "      <td>6.467294</td>\n",
       "      <td>-31.539094</td>\n",
       "      <td>9.37</td>\n",
       "      <td>24-Dec-2020</td>\n",
       "      <td>https://static.nseindia.com/sparklines/365d/TO...</td>\n",
       "      <td>25-Nov-2021</td>\n",
       "      <td>1.86</td>\n",
       "      <td>https://static.nseindia.com/sparklines/30d/TOR...</td>\n",
       "      <td>https://static.nseindia.com/sparklines/today/T...</td>\n",
       "      <td>{'symbol': 'TORNTPHARM', 'companyName': 'Torre...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>186</th>\n",
       "      <td>BIOCON</td>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>363</td>\n",
       "      <td>366</td>\n",
       "      <td>352.5</td>\n",
       "      <td>354.55</td>\n",
       "      <td>374.35</td>\n",
       "      <td>-19.80</td>\n",
       "      <td>-5.29</td>\n",
       "      <td>...</td>\n",
       "      <td>27.309072</td>\n",
       "      <td>-12.627065</td>\n",
       "      <td>-26.46</td>\n",
       "      <td>24-Dec-2020</td>\n",
       "      <td>https://static.nseindia.com/sparklines/365d/BI...</td>\n",
       "      <td>25-Nov-2021</td>\n",
       "      <td>-2.22</td>\n",
       "      <td>https://static.nseindia.com/sparklines/30d/BIO...</td>\n",
       "      <td>https://static.nseindia.com/sparklines/today/B...</td>\n",
       "      <td>{'symbol': 'BIOCON', 'companyName': 'Biocon Li...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>187</th>\n",
       "      <td>L&amp;TFH</td>\n",
       "      <td></td>\n",
       "      <td>EQ</td>\n",
       "      <td>83</td>\n",
       "      <td>83</td>\n",
       "      <td>76.65</td>\n",
       "      <td>77.1</td>\n",
       "      <td>82.6</td>\n",
       "      <td>-5.50</td>\n",
       "      <td>-6.66</td>\n",
       "      <td>...</td>\n",
       "      <td>32.010582</td>\n",
       "      <td>-7.832168</td>\n",
       "      <td>-14.93</td>\n",
       "      <td>24-Dec-2020</td>\n",
       "      <td>https://static.nseindia.com/sparklines/365d/L&amp;...</td>\n",
       "      <td>25-Nov-2021</td>\n",
       "      <td>-2.66</td>\n",
       "      <td>https://static.nseindia.com/sparklines/30d/L&amp;T...</td>\n",
       "      <td>https://static.nseindia.com/sparklines/today/L...</td>\n",
       "      <td>{'symbol': 'L&amp;TFH', 'companyName': 'L&amp;T Financ...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>188 rows × 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         symbol identifier series     open  dayHigh   dayLow lastPrice  \\\n",
       "0           FSL                EQ   175.95      185   172.35     182.8   \n",
       "1       COFORGE                EQ     5468  5668.75  5461.35    5638.5   \n",
       "2       HCLTECH                EQ  1262.15   1283.8  1246.15    1262.6   \n",
       "3    BALKRISIND                EQ     2168  2216.85   2151.3      2197   \n",
       "4         TECHM                EQ  1683.35   1735.2  1680.35      1724   \n",
       "..          ...        ...    ...      ...      ...      ...       ...   \n",
       "183    CHOLAFIN                EQ      541      542   517.65    519.85   \n",
       "184     SYNGENE                EQ    613.6    613.6    589.5     589.9   \n",
       "185  TORNTPHARM                EQ     3180     3199  3036.35      3040   \n",
       "186      BIOCON                EQ      363      366    352.5    354.55   \n",
       "187       L&TFH                EQ       83       83    76.65      77.1   \n",
       "\n",
       "    previousClose  change  pChange  ...    nearWKH     nearWKL perChange365d  \\\n",
       "0          175.05    7.75     4.43  ...  24.727198 -137.402597         99.62   \n",
       "1          5455.5  183.00     3.35  ...   6.492537 -145.152174        112.84   \n",
       "2         1227.45   35.15     2.86  ...   8.357830  -41.705948         37.62   \n",
       "3         2143.95   53.05     2.47  ...  19.340627  -44.858735         41.57   \n",
       "4          1683.8   40.20     2.39  ...   0.645459  -88.415301         81.98   \n",
       "..            ...     ...      ...  ...        ...         ...           ...   \n",
       "183        539.65  -19.80    -3.67  ...  22.108181  -45.087915         38.18   \n",
       "184         613.6  -23.70    -3.86  ...  15.728571  -20.265036         -3.19   \n",
       "185        3162.5 -122.50    -3.87  ...   6.467294  -31.539094          9.37   \n",
       "186        374.35  -19.80    -5.29  ...  27.309072  -12.627065        -26.46   \n",
       "187          82.6   -5.50    -6.66  ...  32.010582   -7.832168        -14.93   \n",
       "\n",
       "     date365dAgo                                      chart365dPath  \\\n",
       "0    24-Dec-2020  https://static.nseindia.com/sparklines/365d/FS...   \n",
       "1    24-Dec-2020  https://static.nseindia.com/sparklines/365d/CO...   \n",
       "2    24-Dec-2020  https://static.nseindia.com/sparklines/365d/HC...   \n",
       "3    24-Dec-2020  https://static.nseindia.com/sparklines/365d/BA...   \n",
       "4    24-Dec-2020  https://static.nseindia.com/sparklines/365d/TE...   \n",
       "..           ...                                                ...   \n",
       "183  24-Dec-2020  https://static.nseindia.com/sparklines/365d/CH...   \n",
       "184  24-Dec-2020  https://static.nseindia.com/sparklines/365d/SY...   \n",
       "185  24-Dec-2020  https://static.nseindia.com/sparklines/365d/TO...   \n",
       "186  24-Dec-2020  https://static.nseindia.com/sparklines/365d/BI...   \n",
       "187  24-Dec-2020  https://static.nseindia.com/sparklines/365d/L&...   \n",
       "\n",
       "      date30dAgo  perChange30d  \\\n",
       "0    25-Nov-2021          6.69   \n",
       "1    25-Nov-2021          2.60   \n",
       "2    25-Nov-2021         12.48   \n",
       "3    25-Nov-2021         -1.72   \n",
       "4    25-Nov-2021         10.55   \n",
       "..           ...           ...   \n",
       "183  25-Nov-2021        -11.00   \n",
       "184  25-Nov-2021          0.42   \n",
       "185  25-Nov-2021          1.86   \n",
       "186  25-Nov-2021         -2.22   \n",
       "187  25-Nov-2021         -2.66   \n",
       "\n",
       "                                          chart30dPath  \\\n",
       "0    https://static.nseindia.com/sparklines/30d/FSL...   \n",
       "1    https://static.nseindia.com/sparklines/30d/COF...   \n",
       "2    https://static.nseindia.com/sparklines/30d/HCL...   \n",
       "3    https://static.nseindia.com/sparklines/30d/BAL...   \n",
       "4    https://static.nseindia.com/sparklines/30d/TEC...   \n",
       "..                                                 ...   \n",
       "183  https://static.nseindia.com/sparklines/30d/CHO...   \n",
       "184  https://static.nseindia.com/sparklines/30d/SYN...   \n",
       "185  https://static.nseindia.com/sparklines/30d/TOR...   \n",
       "186  https://static.nseindia.com/sparklines/30d/BIO...   \n",
       "187  https://static.nseindia.com/sparklines/30d/L&T...   \n",
       "\n",
       "                                        chartTodayPath  \\\n",
       "0    https://static.nseindia.com/sparklines/today/F...   \n",
       "1    https://static.nseindia.com/sparklines/today/C...   \n",
       "2    https://static.nseindia.com/sparklines/today/H...   \n",
       "3    https://static.nseindia.com/sparklines/today/B...   \n",
       "4    https://static.nseindia.com/sparklines/today/T...   \n",
       "..                                                 ...   \n",
       "183  https://static.nseindia.com/sparklines/today/C...   \n",
       "184  https://static.nseindia.com/sparklines/today/S...   \n",
       "185  https://static.nseindia.com/sparklines/today/T...   \n",
       "186  https://static.nseindia.com/sparklines/today/B...   \n",
       "187  https://static.nseindia.com/sparklines/today/L...   \n",
       "\n",
       "                                                  meta  \n",
       "0    {'symbol': 'FSL', 'companyName': 'Firstsource ...  \n",
       "1    {'symbol': 'COFORGE', 'companyName': 'Coforge ...  \n",
       "2    {'symbol': 'HCLTECH', 'companyName': 'HCL Tech...  \n",
       "3    {'symbol': 'BALKRISIND', 'companyName': 'Balkr...  \n",
       "4    {'symbol': 'TECHM', 'companyName': 'Tech Mahin...  \n",
       "..                                                 ...  \n",
       "183  {'symbol': 'CHOLAFIN', 'companyName': 'Cholama...  \n",
       "184  {'symbol': 'SYNGENE', 'companyName': 'Syngene ...  \n",
       "185  {'symbol': 'TORNTPHARM', 'companyName': 'Torre...  \n",
       "186  {'symbol': 'BIOCON', 'companyName': 'Biocon Li...  \n",
       "187  {'symbol': 'L&TFH', 'companyName': 'L&T Financ...  \n",
       "\n",
       "[188 rows x 25 columns]"
      ]
     },
     "execution_count": 43,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df11 = nse_get_advances_declines()\n",
    "df11"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "d428faad",
   "metadata": {},
   "outputs": [],
   "source": [
    "buffer = io.BytesIO()\n",
    "buffer.write(export_csv(df11).encode())\n",
    "buffer.seek(0)\n",
    "buffer.name = f'nse_get_advances_declines.csv'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "b19903da",
   "metadata": {},
   "outputs": [],
   "source": [
    "base_url = \"https://api.telegram.org/bot2116923117:AAFccongYIN7CJwXcIjMbtidduE6IiYEFuM/sendDocument\"\n",
    "\n",
    "parameters = {\n",
    "    \"chat_id\" : \"-777737632\",\n",
    "    \"caption\" : \"nse_get_advances_declines\"\n",
    "}\n",
    "\n",
    "files = {\n",
    "    \"document\" : buffer\n",
    "}\n",
    "\n",
    "resp = requests.get(base_url, data = parameters, files = files)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "3adcf0c0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>symbol</th>\n",
       "      <th>companyName</th>\n",
       "      <th>industry</th>\n",
       "      <th>audited</th>\n",
       "      <th>cumulative</th>\n",
       "      <th>indAs</th>\n",
       "      <th>reInd</th>\n",
       "      <th>period</th>\n",
       "      <th>relatingTo</th>\n",
       "      <th>financialYear</th>\n",
       "      <th>...</th>\n",
       "      <th>fromDate</th>\n",
       "      <th>toDate</th>\n",
       "      <th>oldNewFlag</th>\n",
       "      <th>xbrl</th>\n",
       "      <th>format</th>\n",
       "      <th>params</th>\n",
       "      <th>resultDescription</th>\n",
       "      <th>resultDetailedDataLink</th>\n",
       "      <th>consolidated</th>\n",
       "      <th>isin</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>20MICRONS</td>\n",
       "      <td>20 Microns Limited</td>\n",
       "      <td>-</td>\n",
       "      <td>Un-Audited</td>\n",
       "      <td>Non-cumulative</td>\n",
       "      <td>Ind-AS New</td>\n",
       "      <td>N</td>\n",
       "      <td>Quarterly</td>\n",
       "      <td>Second Quarter</td>\n",
       "      <td>01-Apr-2021 To 31-Mar-2022</td>\n",
       "      <td>...</td>\n",
       "      <td>01-Jul-2021</td>\n",
       "      <td>30-Sep-2021</td>\n",
       "      <td>N</td>\n",
       "      <td>https://archives.nseindia.com/corporate/xbrl/I...</td>\n",
       "      <td>New</td>\n",
       "      <td>01-Jul-202130-Sep-2021Q2UNNNNE20MICRONS</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>Non-Consolidated</td>\n",
       "      <td>INE144J01019</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>20MICRONS</td>\n",
       "      <td>20 Microns Limited</td>\n",
       "      <td>-</td>\n",
       "      <td>Un-Audited</td>\n",
       "      <td>Non-cumulative</td>\n",
       "      <td>Ind-AS New</td>\n",
       "      <td>N</td>\n",
       "      <td>Quarterly</td>\n",
       "      <td>Second Quarter</td>\n",
       "      <td>01-Apr-2021 To 31-Mar-2022</td>\n",
       "      <td>...</td>\n",
       "      <td>01-Jul-2021</td>\n",
       "      <td>30-Sep-2021</td>\n",
       "      <td>N</td>\n",
       "      <td>https://archives.nseindia.com/corporate/xbrl/I...</td>\n",
       "      <td>New</td>\n",
       "      <td>01-Jul-202130-Sep-2021Q2UNNCNE20MICRONS</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>Consolidated</td>\n",
       "      <td>INE144J01019</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>21STCENMGM</td>\n",
       "      <td>21st Century Management Services Limited</td>\n",
       "      <td>-</td>\n",
       "      <td>Un-Audited</td>\n",
       "      <td>Non-cumulative</td>\n",
       "      <td>Ind-AS New</td>\n",
       "      <td>N</td>\n",
       "      <td>Quarterly</td>\n",
       "      <td>Second Quarter</td>\n",
       "      <td>01-Apr-2021 To 31-Mar-2022</td>\n",
       "      <td>...</td>\n",
       "      <td>01-Jul-2021</td>\n",
       "      <td>30-Sep-2021</td>\n",
       "      <td>N</td>\n",
       "      <td>https://archives.nseindia.com/corporate/xbrl/I...</td>\n",
       "      <td>New</td>\n",
       "      <td>01-Jul-202130-Sep-2021Q2UNNNNE21STCENMGM</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>Non-Consolidated</td>\n",
       "      <td>INE253B01015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>21STCENMGM</td>\n",
       "      <td>21st Century Management Services Limited</td>\n",
       "      <td>-</td>\n",
       "      <td>Un-Audited</td>\n",
       "      <td>Non-cumulative</td>\n",
       "      <td>Ind-AS New</td>\n",
       "      <td>N</td>\n",
       "      <td>Quarterly</td>\n",
       "      <td>Second Quarter</td>\n",
       "      <td>01-Apr-2021 To 31-Mar-2022</td>\n",
       "      <td>...</td>\n",
       "      <td>01-Jul-2021</td>\n",
       "      <td>30-Sep-2021</td>\n",
       "      <td>N</td>\n",
       "      <td>https://archives.nseindia.com/corporate/xbrl/I...</td>\n",
       "      <td>New</td>\n",
       "      <td>01-Jul-202130-Sep-2021Q2UNNCNE21STCENMGM</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>Consolidated</td>\n",
       "      <td>INE253B01015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>3IINFOLTD</td>\n",
       "      <td>3i Infotech Limited</td>\n",
       "      <td>-</td>\n",
       "      <td>Un-Audited</td>\n",
       "      <td>Non-cumulative</td>\n",
       "      <td>Ind-AS New</td>\n",
       "      <td>N</td>\n",
       "      <td>Quarterly</td>\n",
       "      <td>Second Quarter</td>\n",
       "      <td>01-Apr-2021 To 31-Mar-2022</td>\n",
       "      <td>...</td>\n",
       "      <td>01-Jul-2021</td>\n",
       "      <td>30-Sep-2021</td>\n",
       "      <td>N</td>\n",
       "      <td>https://archives.nseindia.com/corporate/xbrl/I...</td>\n",
       "      <td>New</td>\n",
       "      <td>01-Jul-202130-Sep-2021Q2UNNNNE3IINFOLTD</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>Non-Consolidated</td>\n",
       "      <td>INE748C01038</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2940</th>\n",
       "      <td>ZUARI</td>\n",
       "      <td>Zuari Agro Chemicals Limited</td>\n",
       "      <td>-</td>\n",
       "      <td>Un-Audited</td>\n",
       "      <td>Non-cumulative</td>\n",
       "      <td>Ind-AS New</td>\n",
       "      <td>N</td>\n",
       "      <td>Quarterly</td>\n",
       "      <td>Second Quarter</td>\n",
       "      <td>01-Apr-2021 To 31-Mar-2022</td>\n",
       "      <td>...</td>\n",
       "      <td>01-Jul-2021</td>\n",
       "      <td>30-Sep-2021</td>\n",
       "      <td>N</td>\n",
       "      <td>https://archives.nseindia.com/corporate/xbrl/I...</td>\n",
       "      <td>New</td>\n",
       "      <td>01-Jul-202130-Sep-2021Q2UNNCNEZUARI</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>Consolidated</td>\n",
       "      <td>INE840M01016</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2941</th>\n",
       "      <td>ZUARIGLOB</td>\n",
       "      <td>Zuari Global Limited</td>\n",
       "      <td>-</td>\n",
       "      <td>Un-Audited</td>\n",
       "      <td>Non-cumulative</td>\n",
       "      <td>Ind-AS New</td>\n",
       "      <td>N</td>\n",
       "      <td>Quarterly</td>\n",
       "      <td>Second Quarter</td>\n",
       "      <td>01-Apr-2021 To 31-Mar-2022</td>\n",
       "      <td>...</td>\n",
       "      <td>01-Jul-2021</td>\n",
       "      <td>30-Sep-2021</td>\n",
       "      <td>N</td>\n",
       "      <td>https://archives.nseindia.com/corporate/xbrl/I...</td>\n",
       "      <td>New</td>\n",
       "      <td>01-Jul-202130-Sep-2021Q2UNNCNEZUARIGLOB</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>Consolidated</td>\n",
       "      <td>INE217A01012</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2942</th>\n",
       "      <td>ZUARIGLOB</td>\n",
       "      <td>Zuari Global Limited</td>\n",
       "      <td>-</td>\n",
       "      <td>Un-Audited</td>\n",
       "      <td>Non-cumulative</td>\n",
       "      <td>Ind-AS New</td>\n",
       "      <td>N</td>\n",
       "      <td>Quarterly</td>\n",
       "      <td>Second Quarter</td>\n",
       "      <td>01-Apr-2021 To 31-Mar-2022</td>\n",
       "      <td>...</td>\n",
       "      <td>01-Jul-2021</td>\n",
       "      <td>30-Sep-2021</td>\n",
       "      <td>N</td>\n",
       "      <td>https://archives.nseindia.com/corporate/xbrl/I...</td>\n",
       "      <td>New</td>\n",
       "      <td>01-Jul-202130-Sep-2021Q2UNNNNEZUARIGLOB</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>Non-Consolidated</td>\n",
       "      <td>INE217A01012</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2943</th>\n",
       "      <td>ZYDUSWELL</td>\n",
       "      <td>Zydus Wellness Limited</td>\n",
       "      <td>-</td>\n",
       "      <td>Un-Audited</td>\n",
       "      <td>Non-cumulative</td>\n",
       "      <td>Ind-AS New</td>\n",
       "      <td>N</td>\n",
       "      <td>Quarterly</td>\n",
       "      <td>Second Quarter</td>\n",
       "      <td>01-Apr-2021 To 31-Mar-2022</td>\n",
       "      <td>...</td>\n",
       "      <td>01-Jul-2021</td>\n",
       "      <td>30-Sep-2021</td>\n",
       "      <td>N</td>\n",
       "      <td>https://archives.nseindia.com/corporate/xbrl/I...</td>\n",
       "      <td>New</td>\n",
       "      <td>01-Jul-202130-Sep-2021Q2UNNCNEZYDUSWELL</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>Consolidated</td>\n",
       "      <td>INE768C01010</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2944</th>\n",
       "      <td>ZYDUSWELL</td>\n",
       "      <td>Zydus Wellness Limited</td>\n",
       "      <td>-</td>\n",
       "      <td>Un-Audited</td>\n",
       "      <td>Non-cumulative</td>\n",
       "      <td>Ind-AS New</td>\n",
       "      <td>N</td>\n",
       "      <td>Quarterly</td>\n",
       "      <td>Second Quarter</td>\n",
       "      <td>01-Apr-2021 To 31-Mar-2022</td>\n",
       "      <td>...</td>\n",
       "      <td>01-Jul-2021</td>\n",
       "      <td>30-Sep-2021</td>\n",
       "      <td>N</td>\n",
       "      <td>https://archives.nseindia.com/corporate/xbrl/I...</td>\n",
       "      <td>New</td>\n",
       "      <td>01-Jul-202130-Sep-2021Q2UNNNNEZYDUSWELL</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>Non-Consolidated</td>\n",
       "      <td>INE768C01010</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2945 rows × 23 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          symbol                               companyName industry  \\\n",
       "0      20MICRONS                        20 Microns Limited        -   \n",
       "1      20MICRONS                        20 Microns Limited        -   \n",
       "2     21STCENMGM  21st Century Management Services Limited        -   \n",
       "3     21STCENMGM  21st Century Management Services Limited        -   \n",
       "4      3IINFOLTD                       3i Infotech Limited        -   \n",
       "...          ...                                       ...      ...   \n",
       "2940       ZUARI              Zuari Agro Chemicals Limited        -   \n",
       "2941   ZUARIGLOB                      Zuari Global Limited        -   \n",
       "2942   ZUARIGLOB                      Zuari Global Limited        -   \n",
       "2943   ZYDUSWELL                    Zydus Wellness Limited        -   \n",
       "2944   ZYDUSWELL                    Zydus Wellness Limited        -   \n",
       "\n",
       "         audited      cumulative       indAs reInd     period      relatingTo  \\\n",
       "0     Un-Audited  Non-cumulative  Ind-AS New     N  Quarterly  Second Quarter   \n",
       "1     Un-Audited  Non-cumulative  Ind-AS New     N  Quarterly  Second Quarter   \n",
       "2     Un-Audited  Non-cumulative  Ind-AS New     N  Quarterly  Second Quarter   \n",
       "3     Un-Audited  Non-cumulative  Ind-AS New     N  Quarterly  Second Quarter   \n",
       "4     Un-Audited  Non-cumulative  Ind-AS New     N  Quarterly  Second Quarter   \n",
       "...          ...             ...         ...   ...        ...             ...   \n",
       "2940  Un-Audited  Non-cumulative  Ind-AS New     N  Quarterly  Second Quarter   \n",
       "2941  Un-Audited  Non-cumulative  Ind-AS New     N  Quarterly  Second Quarter   \n",
       "2942  Un-Audited  Non-cumulative  Ind-AS New     N  Quarterly  Second Quarter   \n",
       "2943  Un-Audited  Non-cumulative  Ind-AS New     N  Quarterly  Second Quarter   \n",
       "2944  Un-Audited  Non-cumulative  Ind-AS New     N  Quarterly  Second Quarter   \n",
       "\n",
       "                   financialYear  ...     fromDate       toDate oldNewFlag  \\\n",
       "0     01-Apr-2021 To 31-Mar-2022  ...  01-Jul-2021  30-Sep-2021          N   \n",
       "1     01-Apr-2021 To 31-Mar-2022  ...  01-Jul-2021  30-Sep-2021          N   \n",
       "2     01-Apr-2021 To 31-Mar-2022  ...  01-Jul-2021  30-Sep-2021          N   \n",
       "3     01-Apr-2021 To 31-Mar-2022  ...  01-Jul-2021  30-Sep-2021          N   \n",
       "4     01-Apr-2021 To 31-Mar-2022  ...  01-Jul-2021  30-Sep-2021          N   \n",
       "...                          ...  ...          ...          ...        ...   \n",
       "2940  01-Apr-2021 To 31-Mar-2022  ...  01-Jul-2021  30-Sep-2021          N   \n",
       "2941  01-Apr-2021 To 31-Mar-2022  ...  01-Jul-2021  30-Sep-2021          N   \n",
       "2942  01-Apr-2021 To 31-Mar-2022  ...  01-Jul-2021  30-Sep-2021          N   \n",
       "2943  01-Apr-2021 To 31-Mar-2022  ...  01-Jul-2021  30-Sep-2021          N   \n",
       "2944  01-Apr-2021 To 31-Mar-2022  ...  01-Jul-2021  30-Sep-2021          N   \n",
       "\n",
       "                                                   xbrl format  \\\n",
       "0     https://archives.nseindia.com/corporate/xbrl/I...    New   \n",
       "1     https://archives.nseindia.com/corporate/xbrl/I...    New   \n",
       "2     https://archives.nseindia.com/corporate/xbrl/I...    New   \n",
       "3     https://archives.nseindia.com/corporate/xbrl/I...    New   \n",
       "4     https://archives.nseindia.com/corporate/xbrl/I...    New   \n",
       "...                                                 ...    ...   \n",
       "2940  https://archives.nseindia.com/corporate/xbrl/I...    New   \n",
       "2941  https://archives.nseindia.com/corporate/xbrl/I...    New   \n",
       "2942  https://archives.nseindia.com/corporate/xbrl/I...    New   \n",
       "2943  https://archives.nseindia.com/corporate/xbrl/I...    New   \n",
       "2944  https://archives.nseindia.com/corporate/xbrl/I...    New   \n",
       "\n",
       "                                        params resultDescription  \\\n",
       "0      01-Jul-202130-Sep-2021Q2UNNNNE20MICRONS              None   \n",
       "1      01-Jul-202130-Sep-2021Q2UNNCNE20MICRONS              None   \n",
       "2     01-Jul-202130-Sep-2021Q2UNNNNE21STCENMGM              None   \n",
       "3     01-Jul-202130-Sep-2021Q2UNNCNE21STCENMGM              None   \n",
       "4      01-Jul-202130-Sep-2021Q2UNNNNE3IINFOLTD              None   \n",
       "...                                        ...               ...   \n",
       "2940       01-Jul-202130-Sep-2021Q2UNNCNEZUARI              None   \n",
       "2941   01-Jul-202130-Sep-2021Q2UNNCNEZUARIGLOB              None   \n",
       "2942   01-Jul-202130-Sep-2021Q2UNNNNEZUARIGLOB              None   \n",
       "2943   01-Jul-202130-Sep-2021Q2UNNCNEZYDUSWELL              None   \n",
       "2944   01-Jul-202130-Sep-2021Q2UNNNNEZYDUSWELL              None   \n",
       "\n",
       "     resultDetailedDataLink      consolidated          isin  \n",
       "0                      None  Non-Consolidated  INE144J01019  \n",
       "1                      None      Consolidated  INE144J01019  \n",
       "2                      None  Non-Consolidated  INE253B01015  \n",
       "3                      None      Consolidated  INE253B01015  \n",
       "4                      None  Non-Consolidated  INE748C01038  \n",
       "...                     ...               ...           ...  \n",
       "2940                   None      Consolidated  INE840M01016  \n",
       "2941                   None      Consolidated  INE217A01012  \n",
       "2942                   None  Non-Consolidated  INE217A01012  \n",
       "2943                   None      Consolidated  INE768C01010  \n",
       "2944                   None  Non-Consolidated  INE768C01010  \n",
       "\n",
       "[2945 rows x 23 columns]"
      ]
     },
     "execution_count": 46,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df12 = nse_results(\"equities\",\"Quarterly\")\n",
    "df12"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "ab1de0c2",
   "metadata": {},
   "outputs": [],
   "source": [
    "buffer = io.BytesIO()\n",
    "buffer.write(export_csv(df12).encode())\n",
    "buffer.seek(0)\n",
    "buffer.name = f'nse_results.csv'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "008ec159",
   "metadata": {},
   "outputs": [],
   "source": [
    "base_url = \"https://api.telegram.org/bot2116923117:AAFccongYIN7CJwXcIjMbtidduE6IiYEFuM/sendDocument\"\n",
    "\n",
    "parameters = {\n",
    "    \"chat_id\" : \"-777737632\",\n",
    "    \"caption\" : \"nse_results\"\n",
    "}\n",
    "\n",
    "files = {\n",
    "    \"document\" : buffer\n",
    "}\n",
    "\n",
    "resp = requests.get(base_url, data = parameters, files = files)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "184d88d5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>symbol</th>\n",
       "      <th>company</th>\n",
       "      <th>purpose</th>\n",
       "      <th>bm_desc</th>\n",
       "      <th>date</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AJANTPHARM</td>\n",
       "      <td>Ajanta Pharma Limited</td>\n",
       "      <td>Buyback</td>\n",
       "      <td>To consider buyback for equity shares</td>\n",
       "      <td>28-Dec-2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>GREENLAM</td>\n",
       "      <td>Greenlam Industries Limited</td>\n",
       "      <td>Fund Raising</td>\n",
       "      <td>In terms of Regulation 29(1) of the SEBI Listi...</td>\n",
       "      <td>28-Dec-2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>MAZDOCK</td>\n",
       "      <td>Mazagon Dock Shipbuilders Limited</td>\n",
       "      <td>Dividend</td>\n",
       "      <td>To consider dividend</td>\n",
       "      <td>28-Dec-2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>MOTOGENFIN</td>\n",
       "      <td>The Motor &amp; General Finance Limited</td>\n",
       "      <td>Other business matters</td>\n",
       "      <td>Intimation regarding convening of Independent ...</td>\n",
       "      <td>28-Dec-2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>GVKPIL</td>\n",
       "      <td>GVK Power &amp; Infrastructure Limited</td>\n",
       "      <td>Financial Results</td>\n",
       "      <td>To consider and approve the financial results ...</td>\n",
       "      <td>28-Dec-2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>INDOSOLAR</td>\n",
       "      <td>Indosolar Limited</td>\n",
       "      <td>Financial Results</td>\n",
       "      <td>To consider and approve the financial results ...</td>\n",
       "      <td>29-Dec-2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>PBAINFRA</td>\n",
       "      <td>PBA Infrastructure Limited</td>\n",
       "      <td>Other business matters</td>\n",
       "      <td>To consider other business matters</td>\n",
       "      <td>29-Dec-2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>ACCURACY</td>\n",
       "      <td>Accuracy Shipping Limited</td>\n",
       "      <td>Other business matters</td>\n",
       "      <td>To consider other business matters</td>\n",
       "      <td>29-Dec-2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>MOKSH</td>\n",
       "      <td>Moksh Ornaments Limited</td>\n",
       "      <td>Fund Raising/Other business matters</td>\n",
       "      <td>To consider Fund Raising and other business ma...</td>\n",
       "      <td>29-Dec-2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>VENUSREM</td>\n",
       "      <td>Venus Remedies Limited</td>\n",
       "      <td>Other business matters</td>\n",
       "      <td>To consider the  appointment of additional dir...</td>\n",
       "      <td>30-Dec-2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>LAXMICOT</td>\n",
       "      <td>Laxmi Cotspin Limited</td>\n",
       "      <td>Other business matters</td>\n",
       "      <td>To consider reappointment of Managing Director...</td>\n",
       "      <td>30-Dec-2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>ANDHRSUGAR</td>\n",
       "      <td>The Andhra Sugars Limited</td>\n",
       "      <td>Other business matters</td>\n",
       "      <td>To consider allotment of Equity Shares of Face...</td>\n",
       "      <td>31-Dec-2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>CGPOWER</td>\n",
       "      <td>CG Power and Industrial Solutions Limited</td>\n",
       "      <td>Other business matters</td>\n",
       "      <td>To consider and approve the revised Audited Fi...</td>\n",
       "      <td>31-Dec-2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>SHIVAMAUTO</td>\n",
       "      <td>Shivam Autotech Limited</td>\n",
       "      <td>Other business matters</td>\n",
       "      <td>To consider and approve appointment of Chief F...</td>\n",
       "      <td>03-Jan-2022</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>SMLT</td>\n",
       "      <td>Sarthak Metals Limited</td>\n",
       "      <td>Dividend/Other business matters</td>\n",
       "      <td>Board Meeting of the Company will be held on M...</td>\n",
       "      <td>03-Jan-2022</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>DHRUV</td>\n",
       "      <td>Dhruv Consultancy Services Limited</td>\n",
       "      <td>Fund Raising</td>\n",
       "      <td>To consider raising of funds by way of rights ...</td>\n",
       "      <td>05-Jan-2022</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>GMBREW</td>\n",
       "      <td>GM Breweries Limited</td>\n",
       "      <td>Financial Results</td>\n",
       "      <td>To consider and approve the financial results ...</td>\n",
       "      <td>07-Jan-2022</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>INFY</td>\n",
       "      <td>Infosys Limited</td>\n",
       "      <td>Financial Results</td>\n",
       "      <td>To consider and approve the financial results ...</td>\n",
       "      <td>12-Jan-2022</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>WIPRO</td>\n",
       "      <td>Wipro Limited</td>\n",
       "      <td>Financial Results/Dividend</td>\n",
       "      <td>To consider and approve the financial results ...</td>\n",
       "      <td>12-Jan-2022</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>HCLTECH</td>\n",
       "      <td>HCL Technologies Limited</td>\n",
       "      <td>Financial Results/Dividend</td>\n",
       "      <td>To consider and approve the financial results ...</td>\n",
       "      <td>14-Jan-2022</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>HDFCBANK</td>\n",
       "      <td>HDFC Bank Limited</td>\n",
       "      <td>Financial Results</td>\n",
       "      <td>To consider and approve the financial results ...</td>\n",
       "      <td>15-Jan-2022</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>MAHSCOOTER</td>\n",
       "      <td>Maharashtra Scooters Limited</td>\n",
       "      <td>Financial Results</td>\n",
       "      <td>To consider and approve the financial results ...</td>\n",
       "      <td>17-Jan-2022</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>BAJFINANCE</td>\n",
       "      <td>Bajaj Finance Limited</td>\n",
       "      <td>Financial Results</td>\n",
       "      <td>To consider and approve the financial results ...</td>\n",
       "      <td>18-Jan-2022</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>RKFORGE</td>\n",
       "      <td>Ramkrishna Forgings Limited</td>\n",
       "      <td>Financial Results/Stock Split</td>\n",
       "      <td>To consider and approve the financial results ...</td>\n",
       "      <td>18-Jan-2022</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>BAJAJ-AUTO</td>\n",
       "      <td>Bajaj Auto Limited</td>\n",
       "      <td>Financial Results</td>\n",
       "      <td>To consider and approve the financial results ...</td>\n",
       "      <td>19-Jan-2022</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>BAJAJFINSV</td>\n",
       "      <td>Bajaj Finserv Limited</td>\n",
       "      <td>Financial Results</td>\n",
       "      <td>To consider and approve the financial results ...</td>\n",
       "      <td>20-Jan-2022</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>BAJAJHLDNG</td>\n",
       "      <td>Bajaj Holdings &amp; Investment Limited</td>\n",
       "      <td>Financial Results</td>\n",
       "      <td>To consider and approve the financial results ...</td>\n",
       "      <td>20-Jan-2022</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>MPHASIS</td>\n",
       "      <td>MphasiS Limited</td>\n",
       "      <td>Financial Results</td>\n",
       "      <td>To consider and approve the financial results ...</td>\n",
       "      <td>20-Jan-2022</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>ICICIBANK</td>\n",
       "      <td>ICICI Bank Limited</td>\n",
       "      <td>Financial Results</td>\n",
       "      <td>To consider the approval of the unaudited fina...</td>\n",
       "      <td>22-Jan-2022</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>AXISBANK</td>\n",
       "      <td>Axis Bank Limited</td>\n",
       "      <td>Financial Results</td>\n",
       "      <td>To consider and approve the financial results ...</td>\n",
       "      <td>24-Jan-2022</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>HDFCAMC</td>\n",
       "      <td>HDFC Asset Management Company Limited</td>\n",
       "      <td>Financial Results</td>\n",
       "      <td>To consider and approve the financial results ...</td>\n",
       "      <td>24-Jan-2022</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>TTKPRESTIG</td>\n",
       "      <td>TTK Prestige Limited</td>\n",
       "      <td>Financial Results</td>\n",
       "      <td>To consider and approve the financial results ...</td>\n",
       "      <td>01-Feb-2022</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32</th>\n",
       "      <td>3MINDIA</td>\n",
       "      <td>3M India Limited</td>\n",
       "      <td>Financial Results/Other business matters</td>\n",
       "      <td>To consider and approve the financial results ...</td>\n",
       "      <td>03-Feb-2022</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>33</th>\n",
       "      <td>EVERESTIND</td>\n",
       "      <td>Everest Industries Limited</td>\n",
       "      <td>Financial Results</td>\n",
       "      <td>To consider and approve the financial results ...</td>\n",
       "      <td>10-Feb-2022</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>34</th>\n",
       "      <td>MAHINDCIE</td>\n",
       "      <td>Mahindra CIE Automotive Limited</td>\n",
       "      <td>Financial Results</td>\n",
       "      <td>To consider and approve the financial results ...</td>\n",
       "      <td>22-Feb-2022</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>35</th>\n",
       "      <td>SANDHAR</td>\n",
       "      <td>Sandhar Technologies Limited</td>\n",
       "      <td>Financial Results</td>\n",
       "      <td>To consider and approve the financial results ...</td>\n",
       "      <td>02-Mar-2022</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        symbol                                    company  \\\n",
       "0   AJANTPHARM                      Ajanta Pharma Limited   \n",
       "1     GREENLAM                Greenlam Industries Limited   \n",
       "2      MAZDOCK          Mazagon Dock Shipbuilders Limited   \n",
       "3   MOTOGENFIN        The Motor & General Finance Limited   \n",
       "4       GVKPIL         GVK Power & Infrastructure Limited   \n",
       "5    INDOSOLAR                          Indosolar Limited   \n",
       "6     PBAINFRA                 PBA Infrastructure Limited   \n",
       "7     ACCURACY                  Accuracy Shipping Limited   \n",
       "8        MOKSH                    Moksh Ornaments Limited   \n",
       "9     VENUSREM                     Venus Remedies Limited   \n",
       "10    LAXMICOT                      Laxmi Cotspin Limited   \n",
       "11  ANDHRSUGAR                  The Andhra Sugars Limited   \n",
       "12     CGPOWER  CG Power and Industrial Solutions Limited   \n",
       "13  SHIVAMAUTO                    Shivam Autotech Limited   \n",
       "14        SMLT                     Sarthak Metals Limited   \n",
       "15       DHRUV         Dhruv Consultancy Services Limited   \n",
       "16      GMBREW                       GM Breweries Limited   \n",
       "17        INFY                            Infosys Limited   \n",
       "18       WIPRO                              Wipro Limited   \n",
       "19     HCLTECH                   HCL Technologies Limited   \n",
       "20    HDFCBANK                          HDFC Bank Limited   \n",
       "21  MAHSCOOTER               Maharashtra Scooters Limited   \n",
       "22  BAJFINANCE                      Bajaj Finance Limited   \n",
       "23     RKFORGE                Ramkrishna Forgings Limited   \n",
       "24  BAJAJ-AUTO                         Bajaj Auto Limited   \n",
       "25  BAJAJFINSV                      Bajaj Finserv Limited   \n",
       "26  BAJAJHLDNG        Bajaj Holdings & Investment Limited   \n",
       "27     MPHASIS                            MphasiS Limited   \n",
       "28   ICICIBANK                         ICICI Bank Limited   \n",
       "29    AXISBANK                          Axis Bank Limited   \n",
       "30     HDFCAMC      HDFC Asset Management Company Limited   \n",
       "31  TTKPRESTIG                       TTK Prestige Limited   \n",
       "32     3MINDIA                           3M India Limited   \n",
       "33  EVERESTIND                 Everest Industries Limited   \n",
       "34   MAHINDCIE            Mahindra CIE Automotive Limited   \n",
       "35     SANDHAR               Sandhar Technologies Limited   \n",
       "\n",
       "                                     purpose  \\\n",
       "0                                    Buyback   \n",
       "1                               Fund Raising   \n",
       "2                                   Dividend   \n",
       "3                     Other business matters   \n",
       "4                          Financial Results   \n",
       "5                          Financial Results   \n",
       "6                     Other business matters   \n",
       "7                     Other business matters   \n",
       "8        Fund Raising/Other business matters   \n",
       "9                     Other business matters   \n",
       "10                    Other business matters   \n",
       "11                    Other business matters   \n",
       "12                    Other business matters   \n",
       "13                    Other business matters   \n",
       "14           Dividend/Other business matters   \n",
       "15                              Fund Raising   \n",
       "16                         Financial Results   \n",
       "17                         Financial Results   \n",
       "18                Financial Results/Dividend   \n",
       "19                Financial Results/Dividend   \n",
       "20                         Financial Results   \n",
       "21                         Financial Results   \n",
       "22                         Financial Results   \n",
       "23             Financial Results/Stock Split   \n",
       "24                         Financial Results   \n",
       "25                         Financial Results   \n",
       "26                         Financial Results   \n",
       "27                         Financial Results   \n",
       "28                         Financial Results   \n",
       "29                         Financial Results   \n",
       "30                         Financial Results   \n",
       "31                         Financial Results   \n",
       "32  Financial Results/Other business matters   \n",
       "33                         Financial Results   \n",
       "34                         Financial Results   \n",
       "35                         Financial Results   \n",
       "\n",
       "                                              bm_desc         date  \n",
       "0               To consider buyback for equity shares  28-Dec-2021  \n",
       "1   In terms of Regulation 29(1) of the SEBI Listi...  28-Dec-2021  \n",
       "2                                To consider dividend  28-Dec-2021  \n",
       "3   Intimation regarding convening of Independent ...  28-Dec-2021  \n",
       "4   To consider and approve the financial results ...  28-Dec-2021  \n",
       "5   To consider and approve the financial results ...  29-Dec-2021  \n",
       "6                  To consider other business matters  29-Dec-2021  \n",
       "7                  To consider other business matters  29-Dec-2021  \n",
       "8   To consider Fund Raising and other business ma...  29-Dec-2021  \n",
       "9   To consider the  appointment of additional dir...  30-Dec-2021  \n",
       "10  To consider reappointment of Managing Director...  30-Dec-2021  \n",
       "11  To consider allotment of Equity Shares of Face...  31-Dec-2021  \n",
       "12  To consider and approve the revised Audited Fi...  31-Dec-2021  \n",
       "13  To consider and approve appointment of Chief F...  03-Jan-2022  \n",
       "14  Board Meeting of the Company will be held on M...  03-Jan-2022  \n",
       "15  To consider raising of funds by way of rights ...  05-Jan-2022  \n",
       "16  To consider and approve the financial results ...  07-Jan-2022  \n",
       "17  To consider and approve the financial results ...  12-Jan-2022  \n",
       "18  To consider and approve the financial results ...  12-Jan-2022  \n",
       "19  To consider and approve the financial results ...  14-Jan-2022  \n",
       "20  To consider and approve the financial results ...  15-Jan-2022  \n",
       "21  To consider and approve the financial results ...  17-Jan-2022  \n",
       "22  To consider and approve the financial results ...  18-Jan-2022  \n",
       "23  To consider and approve the financial results ...  18-Jan-2022  \n",
       "24  To consider and approve the financial results ...  19-Jan-2022  \n",
       "25  To consider and approve the financial results ...  20-Jan-2022  \n",
       "26  To consider and approve the financial results ...  20-Jan-2022  \n",
       "27  To consider and approve the financial results ...  20-Jan-2022  \n",
       "28  To consider the approval of the unaudited fina...  22-Jan-2022  \n",
       "29  To consider and approve the financial results ...  24-Jan-2022  \n",
       "30  To consider and approve the financial results ...  24-Jan-2022  \n",
       "31  To consider and approve the financial results ...  01-Feb-2022  \n",
       "32  To consider and approve the financial results ...  03-Feb-2022  \n",
       "33  To consider and approve the financial results ...  10-Feb-2022  \n",
       "34  To consider and approve the financial results ...  22-Feb-2022  \n",
       "35  To consider and approve the financial results ...  02-Mar-2022  "
      ]
     },
     "execution_count": 49,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df13 = nse_events()\n",
    "df13"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "4886c5aa",
   "metadata": {},
   "outputs": [],
   "source": [
    "buffer = io.BytesIO()\n",
    "buffer.write(export_csv(df13).encode())\n",
    "buffer.seek(0)\n",
    "buffer.name = f'nse_events.csv'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "42ecc857",
   "metadata": {},
   "outputs": [],
   "source": [
    "base_url = \"https://api.telegram.org/bot2116923117:AAFccongYIN7CJwXcIjMbtidduE6IiYEFuM/sendDocument\"\n",
    "\n",
    "parameters = {\n",
    "    \"chat_id\" : \"-777737632\",\n",
    "    \"caption\" : \"nse_events\"\n",
    "}\n",
    "\n",
    "files = {\n",
    "    \"document\" : buffer\n",
    "}\n",
    "\n",
    "resp = requests.get(base_url, data = parameters, files = files)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "67fb15aa",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tradingDate</th>\n",
       "      <th>weekDay</th>\n",
       "      <th>description</th>\n",
       "      <th>Sr_no</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>26-Jan-2021</td>\n",
       "      <td>Tuesday</td>\n",
       "      <td>Republic Day\\r</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>11-Mar-2021</td>\n",
       "      <td>Thursday</td>\n",
       "      <td>Mahashivratri\\r</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>29-Mar-2021</td>\n",
       "      <td>Monday</td>\n",
       "      <td>Holi\\r</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>02-Apr-2021</td>\n",
       "      <td>Friday</td>\n",
       "      <td>Good Friday\\r</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>14-Apr-2021</td>\n",
       "      <td>Wednesday</td>\n",
       "      <td>Dr.Baba Saheb Ambedkar Jayanti\\r</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>21-Apr-2021</td>\n",
       "      <td>Wednesday</td>\n",
       "      <td>Ram Navami\\r</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>25-Apr-2021</td>\n",
       "      <td>Sunday</td>\n",
       "      <td>Mahavir Jayanti\\r</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>01-May-2021</td>\n",
       "      <td>Saturday</td>\n",
       "      <td>Maharashtra Day\\r</td>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>13-May-2021</td>\n",
       "      <td>Thursday</td>\n",
       "      <td>Id-Ul-Fitr (Ramzan ID)\\r</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>21-Jul-2021</td>\n",
       "      <td>Wednesday</td>\n",
       "      <td>Bakri Id\\r</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>15-Aug-2021</td>\n",
       "      <td>Sunday</td>\n",
       "      <td>Independence Day\\r</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>19-Aug-2021</td>\n",
       "      <td>Thursday</td>\n",
       "      <td>Moharram\\r</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>10-Sep-2021</td>\n",
       "      <td>Friday</td>\n",
       "      <td>Ganesh Chaturthi\\r</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>02-Oct-2021</td>\n",
       "      <td>Saturday</td>\n",
       "      <td>Mahatma Gandhi Jayanti\\r</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>15-Oct-2021</td>\n",
       "      <td>Friday</td>\n",
       "      <td>Dussehra\\r</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>05-Nov-2021</td>\n",
       "      <td>Friday</td>\n",
       "      <td>Diwali-Balipratipada\\r</td>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>19-Nov-2021</td>\n",
       "      <td>Friday</td>\n",
       "      <td>Gurunanak Jayanti\\r</td>\n",
       "      <td>17</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>25-Dec-2021</td>\n",
       "      <td>Saturday</td>\n",
       "      <td>Christmas\\r</td>\n",
       "      <td>18</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    tradingDate    weekDay                       description  Sr_no\n",
       "0   26-Jan-2021    Tuesday                    Republic Day\\r      1\n",
       "1   11-Mar-2021   Thursday                   Mahashivratri\\r      2\n",
       "2   29-Mar-2021     Monday                            Holi\\r      3\n",
       "3   02-Apr-2021     Friday                     Good Friday\\r      4\n",
       "4   14-Apr-2021  Wednesday  Dr.Baba Saheb Ambedkar Jayanti\\r      5\n",
       "5   21-Apr-2021  Wednesday                      Ram Navami\\r      6\n",
       "6   25-Apr-2021     Sunday                 Mahavir Jayanti\\r      7\n",
       "7   01-May-2021   Saturday                 Maharashtra Day\\r      8\n",
       "8   13-May-2021   Thursday          Id-Ul-Fitr (Ramzan ID)\\r      9\n",
       "9   21-Jul-2021  Wednesday                        Bakri Id\\r     10\n",
       "10  15-Aug-2021     Sunday                Independence Day\\r     11\n",
       "11  19-Aug-2021   Thursday                        Moharram\\r     12\n",
       "12  10-Sep-2021     Friday                Ganesh Chaturthi\\r     13\n",
       "13  02-Oct-2021   Saturday          Mahatma Gandhi Jayanti\\r     14\n",
       "14  15-Oct-2021     Friday                        Dussehra\\r     15\n",
       "15  05-Nov-2021     Friday            Diwali-Balipratipada\\r     16\n",
       "16  19-Nov-2021     Friday               Gurunanak Jayanti\\r     17\n",
       "17  25-Dec-2021   Saturday                       Christmas\\r     18"
      ]
     },
     "execution_count": 52,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df14 = pd.json_normalize(nse_holidays()['FO'])\n",
    "df14"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "b76018e1",
   "metadata": {},
   "outputs": [],
   "source": [
    "buffer = io.BytesIO()\n",
    "buffer.write(export_csv(df14).encode())\n",
    "buffer.seek(0)\n",
    "buffer.name = f'nse_holidays.csv'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "752aa91a",
   "metadata": {},
   "outputs": [],
   "source": [
    "base_url = \"https://api.telegram.org/bot2116923117:AAFccongYIN7CJwXcIjMbtidduE6IiYEFuM/sendDocument\"\n",
    "\n",
    "parameters = {\n",
    "    \"chat_id\" : \"-777737632\",\n",
    "    \"caption\" : \"nse_holidays\"\n",
    "}\n",
    "\n",
    "files = {\n",
    "    \"document\" : buffer\n",
    "}\n",
    "\n",
    "resp = requests.get(base_url, data = parameters, files = files)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fdc0d472",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
